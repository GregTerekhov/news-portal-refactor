import{u as R,a as W,b as _,r as B,R as s,P,V as A,S as D,c as V,d as j,e as q,f as Q,g as U,h as Y,i as Z,L as G,N as L}from"./index-dc0e1b5b.js";import{u as J}from"./useToast-7b201bf3.js";import{P as X,N as F}from"./NewsList-debc2ba2.js";import"./images-cf2399bf.js";const b=(n,e,i)=>{const c=[e];let r=n-e;for(;r>0;)c.push(i),r-=i;return c},M=(n,e)=>{const i=n&&n.slice(0,-1).reduce((r,f)=>r+f,0);return e-i},k=(n,e,i)=>b(n,e,i),ee=(n,e)=>{try{return M(n,e)}catch(i){return console.error(i.message)}},te=n=>{const{breakpointsForMarkup:e}=R()||{breakpointsForMarkup:null},{popularNews:i,newsByKeyword:c,newsByCategory:r,newsByDate:f}=W(),{filteredNews:E}=_(),[u,t]=B.useState(1),[d,a]=B.useState([]),m=n&&(n==null?void 0:n.length)||0,p=(e==null?void 0:e.isNothing)||(e==null?void 0:e.isMobile),o=N(),g=y(),v=k(m,o,g),h=v[u-1]||0,l=ee(v,m);B.useEffect(()=>{if(n&&(n==null?void 0:n.length)>0){const C=u*h-1>=m;let w,x;u===1?(w=u*h,x=w-h):u>1&&C&&l?(w=m,x=m-l):(w=u*h-1,x=w-h);const O=n.slice(x,w);a(O)}},[i,c,r,f,E,u]);function N(){return e!=null&&e.isNothing||e!=null&&e.isMobile?4:e!=null&&e.isTablet?7:8}function y(){return p?5:e!=null&&e.isTablet?8:9}const T=Math.ceil(u!==1&&p?m/h+1:m/h),I=Array.from({length:T},(C,w)=>w+1);return{currentItems:d,pageNumbers:I,currentPage:u,setCurrentPage:t}},S="w-32",H=24,se=({pageNumbers:n,currentPage:e,setCurrentPage:i})=>{const{breakpointsForMarkup:c}=R()??{breakpointsForMarkup:null},r=(c==null?void 0:c.isTablet)||(c==null?void 0:c.isDesktop),f=n.length,E=window.innerHeight,u=r?6:3,t=[],d=1,a=f,m=e-1,p=e+1,o=l=>s.createElement("li",{key:l,className:`${l===e?"active":""}`,onClick:()=>{i(l),window.scrollTo({top:0+E,left:0})}},s.createElement(P,{"aria-label":l.toString(),classNameButton:`h-10 border-accentBase font-medium transition-colors duration-500 ${l===e?"bg-accentBase text-contrastWhite":"text-darkBase dark:text-whiteBase dark:border-whiteBase"}`,variant:A.Small},l)),g=l=>s.createElement("li",{key:l,className:"ellipsis"},s.createElement("span",{className:"text-darkBase dark:text-whiteBase"},"..."));if(f<=u)for(let l=d;l<=a;l+=1)t.push(o(l));else e===d?(t.push(o(e)),t.push(o(p)),t.push(g("next")),t.push(o(a))):e===a?(t.push(o(d)),t.push(g("prev")),t.push(o(m)),t.push(o(e))):e>d&&e<a&&(e===2&&(t.push(g("prev")),t.push(o(e)),t.push(o(p)),t.push(g("next")),t.push(o(a))),e-1>d&&e+1!==a&&(t.push(g("prev")),t.push(o(m)),t.push(o(e)),t.push(o(p)),t.push(g("next"))),e+1===a&&(t.push(g("prev")),t.push(o(m)),t.push(o(e)),t.push(o(a))));const v=()=>{e>1&&(i(e-1),window.scrollTo({top:0+E,left:0}))},h=()=>{e<n.length&&(i(e+1),window.scrollTo({top:0+E,left:0}))};return s.createElement("div",{className:"flex justify-center items-center gap-2"},s.createElement(P,{id:"Previous page button",variant:A.Other,onHandleClick:v,width:S,disabled:e-1===0},s.createElement(D,{svgName:"icon-arrow-left",size:H,className:"fill-whiteBase"}),r?s.createElement("span",{className:"text-base md:text-medium font-medium text-contrastWhite"},"Prev"):null),s.createElement("ul",{id:"page-numbers",className:"flex gap-2"},t),s.createElement(P,{id:"Next page button",variant:A.Other,onHandleClick:h,width:S,disabled:e===a},r?s.createElement("span",{className:"text-base md:text-medium font-medium text-contrastWhite"},"Next"):null,s.createElement(D,{svgName:"icon-arrow-left",size:H,className:"fill-whiteBase rotate-180"})))},ne="1",ce=()=>{const{isLoadingAPIData:n,errorAPI:e,headline:i,newsByCategory:c,newsByDate:r,newsByKeyword:f,fetchPopular:E}=W(),{isLoadingDBData:u,getSavedNews:t}=V(),{isAuthenticated:d,authError:a}=j(),{openToast:m,setOpenToast:p}=q(),{showErrorToast:o}=J(),g=Q(),v=U(g),{rebuildedNews:h}=Y({activeLinks:v}),{hasResults:l}=_(),{currentItems:N,currentPage:y,pageNumbers:T,setCurrentPage:I}=te(h??[]),C=e==null?void 0:e.toString().includes("429"),w=Z();B.useEffect(()=>{e&&e>=500&&w("/serverError")},[e]),B.useEffect(()=>{E(ne),d&&t()},[E,t,d]),B.useEffect(()=>{(f||c||r)&&p(!0)},[f,c,r]);const x=n||u||l==="loading",O=h&&h.length===0||l==="empty",$=f&&f.length>0||c&&c.length>0||r&&r.length>0,z=!x&&$,K=a&&a.message||e;return s.createElement(s.Fragment,null,x?s.createElement(G,{variant:"generalSection"}):s.createElement(s.Fragment,null,O||C?s.createElement(X,{variant:"page"}):s.createElement(s.Fragment,null,i&&s.createElement("h2",{className:"mb-6 text-giant font-bold dark:text-whiteBase"},i),s.createElement(F,{currentItems:N,currentPage:y}),s.createElement(se,{pageNumbers:T,currentPage:y,setCurrentPage:I}))),K&&s.createElement(L,{openToast:m,setOpenToast:p,title:`${a!=null&&a.message?"Authorisation error":"News API Error"}`,description:a!=null&&a.message||e?o():""}),z&&s.createElement(L,{variant:"non-interactive",openToast:m,setOpenToast:p,title:"Found news",description:`There are ${h.length} news has been found`}))};export{ce as default};

import{u as H,a as W,b as q,r as y,R as t,P as S,V as L,S as D,c as _,d as z,e as K,f as Q,g as U,h as V,L as j,N as P}from"./index-63304fe8.js";import{u as J}from"./useToast-3690aaa8.js";import{P as Y,N as Z}from"./NewsList-a047aeae.js";import"./images-a5b4099d.js";const G=(n,e,l)=>{const c=[e];let r=n-e;for(;r>0;)c.push(l),r-=l;return c},X=(n,e)=>{const l=n&&n.slice(0,-1).reduce((r,f)=>r+f,0);return e-l},b=(n,e,l)=>G(n,e,l),F=(n,e)=>{try{return X(n,e)}catch(l){return console.error(l.message)}},M=n=>{const{breakpointsForMarkup:e}=H()||{breakpointsForMarkup:null},{popularNews:l,newsByKeyword:c,newsByCategory:r,newsByDate:f}=W(),{filteredNews:w}=q(),[u,s]=y.useState(1),[p,o]=y.useState([]),h=n&&(n==null?void 0:n.length)||0,E=(e==null?void 0:e.isNothing)||(e==null?void 0:e.isMobile),a=v(),d=C(),x=b(h,a,d),m=x[u-1]||0,i=F(x,h);y.useEffect(()=>{if(n&&(n==null?void 0:n.length)>0){const T=u*m-1>=h;let g,B;u===1?(g=u*m,B=g-m):u>1&&T&&i?(g=h,B=h-i):(g=u*m-1,B=g-m);const O=n.slice(B,g);o(O)}},[l,c,r,f,w,u]);function v(){return e!=null&&e.isNothing||e!=null&&e.isMobile?4:e!=null&&e.isTablet?7:8}function C(){return E?5:e!=null&&e.isTablet?8:9}const N=Math.ceil(u!==1&&E?h/m+1:h/m),I=Array.from({length:N},(T,g)=>g+1);return{currentItems:p,pageNumbers:I,currentPage:u,setCurrentPage:s}},R="w-32",A=24,k=({pageNumbers:n,currentPage:e,setCurrentPage:l})=>{const{breakpointsForMarkup:c}=H()??{breakpointsForMarkup:null},r=(c==null?void 0:c.isTablet)||(c==null?void 0:c.isDesktop),f=n.length,w=window.innerHeight,u=r?6:3,s=[],p=1,o=f,h=e-1,E=e+1,a=i=>t.createElement("li",{key:i,className:`${i===e?"active":""}`,onClick:()=>{l(i),window.scrollTo({top:0+w,left:0})}},t.createElement(S,{"aria-label":i.toString(),classNameButton:`h-10 border-accentBase font-medium transition-colors duration-500 ${i===e?"bg-accentBase text-contrastWhite":"text-darkBase dark:text-whiteBase dark:border-whiteBase"}`,variant:L.Small},i)),d=i=>t.createElement("li",{key:i,className:"ellipsis"},t.createElement("span",{className:"text-darkBase dark:text-whiteBase"},"..."));if(f<=u)for(let i=p;i<=o;i+=1)s.push(a(i));else e===p?(s.push(a(e)),s.push(a(E)),s.push(d("next")),s.push(a(o))):e===o?(s.push(a(p)),s.push(d("prev")),s.push(a(h)),s.push(a(e))):e>p&&e<o&&(e===2&&(s.push(d("prev")),s.push(a(e)),s.push(a(E)),s.push(d("next")),s.push(a(o))),e-1>p&&e+1!==o&&(s.push(d("prev")),s.push(a(h)),s.push(a(e)),s.push(a(E)),s.push(d("next"))),e+1===o&&(s.push(d("prev")),s.push(a(h)),s.push(a(e)),s.push(a(o))));const x=()=>{e>1&&(l(e-1),window.scrollTo({top:0+w,left:0}))},m=()=>{e<n.length&&(l(e+1),window.scrollTo({top:0+w,left:0}))};return t.createElement("div",{className:"flex justify-center items-center gap-2"},t.createElement(S,{id:"Previous page button",variant:L.Other,onHandleClick:x,width:R,disabled:e-1===0},t.createElement(D,{svgName:"icon-arrow-left",size:A,className:"fill-whiteBase"}),r?t.createElement("span",{className:"text-base md:text-medium font-medium text-contrastWhite"},"Prev"):null),t.createElement("ul",{id:"page-numbers",className:"flex gap-2"},s),t.createElement(S,{id:"Next page button",variant:L.Other,onHandleClick:m,width:R,disabled:e===o},r?t.createElement("span",{className:"text-base md:text-medium font-medium text-contrastWhite"},"Next"):null,t.createElement(D,{svgName:"icon-arrow-left",size:A,className:"fill-whiteBase rotate-180"})))},ee=()=>t.createElement("div",null,t.createElement("h1",null,"429"),t.createElement("h2",null,"TOO MANY REQUESTS"),t.createElement("p",null,"It seems you have been send too much requests then its needed"),t.createElement("p",null,"Just wait a bit and refresh the page one more time"),t.createElement("p",null,"but only one time")),le=()=>{const{isLoadingAPIData:n,headline:e,errorAPI:l,newsByCategory:c,newsByDate:r,newsByKeyword:f,fetchPopular:w}=W(),{isLoadingDBData:u,getSavedNews:s}=_(),{isAuthenticated:p,authError:o}=z(),{openToast:h,setOpenToast:E}=K(),{showErrorToast:a}=J(),d=Q(),x=U(d),{rebuildedNews:m}=V({activeLinks:x}),{hasResults:i}=q(),{currentItems:v,currentPage:C,pageNumbers:N,setCurrentPage:I}=M(m??[]),T=l==null?void 0:l.toString().includes("429");y.useEffect(()=>{w("1"),p&&s()},[w,s,p]),y.useEffect(()=>{(f||c||r)&&E(!0)},[f,c,r]);const g=n||u&&m&&(v==null?void 0:v.length)===0||i==="loading",B=m&&m.length===0||i==="empty",O=f&&f.length>0||c&&c.length>0||r&&r.length>0,$=!g&&O;return t.createElement(t.Fragment,null,g?t.createElement(j,{variant:"generalSection"}):T?t.createElement(ee,null):t.createElement(t.Fragment,null,B?t.createElement(Y,{variant:"page"}):t.createElement(t.Fragment,null,e&&t.createElement("h2",{className:"dark:text-whiteBase text-giant font-bold mb-6"},e),t.createElement(Z,{currentItems:v,currentPage:C}),t.createElement(k,{pageNumbers:N,currentPage:C,setCurrentPage:I}))),o&&o.message&&t.createElement(P,{openToast:h,setOpenToast:E,title:`${(o==null?void 0:o.message)&&"Authorisation error"}`,description:o.message?a():""}),$&&t.createElement(P,{variant:"non-interactive",openToast:h,setOpenToast:E,title:"Found news",description:`There are ${m.length} news has been found`}))};export{le as default};

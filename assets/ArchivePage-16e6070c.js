import{j as C,d as S,b as k,R as e,S as L,C as D,r as f,k as A,l as I,m as _,U as R,n as $,M as U,A as O}from"./index-ef0131dd.js";import{D as F,P as j,N as W}from"./PageTemplate-c1fb51fb.js";import"./images-15c610fa.js";import"./Toast-b2179e70.js";const v=[{label:"Title"},{label:"Category"},{label:"Addition Date"},{label:"Deletion Date"}],G=56,V=87,z=a=>{const s={};return(a==null?void 0:a.length)>0&&a.forEach(t=>{const n=t==null?void 0:t.additionDate;if(n){const l=C(n).fullMonthYear;s[l]||(s[l]=[]),s[l].push(t)}}),s},H=(a,s)=>{let t;switch(!0){case s:t=V;break;default:t=G;break}return a.length>t?`${a.slice(0,t)}...`:a},T=({toggleModal:a})=>{const{getHistoryLog:s}=S(),{isNotMobile:t}=k(),n="group flex items-center gap-x-4 text-accentBase transition-colors duration-500 hocus:text-accentAlt dark:text-whiteBase dark:hocus:text-accentBase max-md:absolute max-md:top-0 max-md:h-10 max-md:w-10 max-md:justify-center",l="fill-accentBase group-hover:fill-accentAlt group-focus:fill-accentAlt dark:fill-whiteBase dark:group-hover:fill-accentBase dark:group-focus:fill-accentBase",r=[{type:"submit",iconName:"reset",label:"Update log"},{type:"button",iconName:"trash",label:"Clear log"}];return e.createElement(e.Fragment,null,Array.isArray(r)&&r.map(({type:c,iconName:o,label:i})=>e.createElement(e.Fragment,{key:o},e.createElement("button",{type:c,onClick:c==="button"?a:s,className:`${n} ${o==="reset"?"max-md:right-12":"max-md:right-0"}`},t?i:null,e.createElement(L,{svgName:o,sizeKey:"smIcon18",className:l})))))},q=({displayedRows:a})=>{const{wideScreens:s}=k(),t="whitespace-nowrap px-6 text-small font-medium text-darkBase dark:text-whiteBase lg:text-medium group-hover:text-whiteBase transition-colors duration-500";return e.createElement(D,{isOpen:!0,orientation:"horizontal"},e.createElement("table",{className:"mb-2.5 min-w-full divide-y divide-greyAlt/[.4] transition-colors duration-500 dark:divide-greyBase/[.4]"},e.createElement("thead",{className:"bg-accentBase/[.2] transition-colors duration-500 dark:bg-greyBase/[.4]"},e.createElement("tr",null,v==null?void 0:v.map(({label:n})=>e.createElement("th",{key:n,scope:"col",className:"px-6 py-3 text-start text-xs font-medium uppercase text-greyBase transition-colors duration-500 dark:text-whiteBase md:text-small lg:text-xl"},n)))),e.createElement("tbody",{className:"divide-y divide-whiteBase transition-colors duration-500 dark:divide-gray-700"},Array.isArray(a)&&a.map(({title:n,newsUrl:l,category:r,additionDate:c,deletionDate:o})=>e.createElement("tr",{key:l,className:"group transition-colors duration-500 even:bg-greyAlt/[.1] hover:bg-accentBase/65"},e.createElement("td",{className:`${t}`},e.createElement("a",{href:l,target:"_blank",rel:"noopener noreferrer nofollow",className:"block py-4 lg:text-medium"},H(n,s))),e.createElement("td",{className:`${t}`},r),e.createElement("td",{className:`${t}`},C(c).dayMonthYear),e.createElement("td",{className:`${t}`},C(o).dayMonthYear))))))},M=({handlePageChange:a,currentPage:s,label:t,position:n,iconClass:l})=>{const r=n<s,c="group inline-flex items-center gap-x-2 rounded-full p-2.5 transition-colors duration-500 hocus:bg-accentBase disabled:pointer-events-none disabled:opacity-50 dark:hocus:bg-accentBase dark:focus:outline-none dark:focus:ring-1 dark:focus:ring-gray-600";return e.createElement("button",{type:"button",onClick:()=>a(r?s-1:s+1),disabled:s===n,className:c},e.createElement("span",{"aria-hidden":"true"},e.createElement(L,{svgName:"arrow",sizeKey:"xsIcon14",className:`${l} fill-accentBase group-hover:fill-whiteBase group-focus:fill-whiteBase dark:fill-whiteBase`})),e.createElement("span",{className:"sr-only"},t))},K=4,X=5,N=2,y=3,p=1,Y=({currentPage:a,handlePageChange:s,totalPages:t})=>{const{isMobile:n}=k(),l=()=>{const c=[],o=(d,x)=>d===x?"bg-accentBase text-whiteBase":"bg-transparent text-darkBase dark:text-whiteBase",i=(d,x)=>{for(let h=d;h<=x;h+=p)c.push(e.createElement("button",{key:h,type:"button","aria-current":"page",className:`${r} ${o(a,h)}`,onClick:()=>s(h)},h))},m=d=>{c.push(e.createElement("span",{key:`dots${d}`,className:"flex w-10 items-center justify-center text-darkBase dark:text-whiteBase"},"..."))},E=()=>{c.push(e.createElement("button",{key:t,type:"button","aria-current":"page",className:`${r} ${o(a,t)}`,onClick:()=>s(t)},t))},g=a+N===t||a+p===t||a===t,b=a+y===t||a+N===t||a+p===t||a===t;return n?t<=K?i(p,t):a===p?(i(p,N),m("next"),E()):g?(m("prev"),i(t-N,t)):a+N<t&&(m("prev"),i(a,a),m("next"),E()):t<=X?i(p,t):a===p?(i(p,y),m("next"),E()):b?(m("prev"),i(t-y,t)):a+y<t&&(m("prev"),i(a,a+p),m("next"),E()),c},r="flex w-10 h-10 items-center justify-center rounded-full py-2.5 text-small text-darkBase transition-colors duration-500 hocus:bg-accentBase hocus:text-whiteBase dark:text-whiteBase dark:hocus:bg-accentBase lg:text-medium";return e.createElement(e.Fragment,null,l())},J=({handlePageChange:a,currentPage:s,totalPages:t})=>e.createElement("nav",{className:"flex items-center space-x-1 py-2"},e.createElement(M,{handlePageChange:a,currentPage:s,label:"Previous",position:1,iconClass:"rotate-90"}),e.createElement(Y,{currentPage:s,totalPages:t,handlePageChange:a}),e.createElement(M,{handlePageChange:a,currentPage:s,label:"Next",position:t,iconClass:"-rotate-90"})),B=1,w=7,Q=a=>{const[s,t]=f.useState(""),[n,l]=f.useState(B),r=f.useMemo(()=>s?a.filter(d=>d.title.toLowerCase().includes(s.toLowerCase())):a,[a,s]),c=r.length,o=Math.ceil(c/w),i=(n-B)*w,m=i+w,E=r.slice(i,m),g=f.useCallback(d=>{const x=d.target.value;t(x),l(B)},[]),b=f.useCallback(d=>{d>=B&&d<=o&&l(d)},[o]);return{searchValue:s,currentPage:n,totalPages:o,displayedRows:E,handleSearchNews:g,handlePageChange:b}},Z=({logData:a})=>{const{clearLog:s}=S(),{showToast:t}=A(),{isMobile:n,isNotMobile:l}=k(),{isOpenModal:r,modalType:c}=I(),{toggleModal:o,popUpRef:i}=_(),{searchValue:m,currentPage:E,totalPages:g,displayedRows:b,handlePageChange:d,handleSearchNews:x}=Q(a),h=async()=>{try{const u=await s();t(u.meta.requestStatus)}catch(u){console.error("Error during clearLog:",u)}o()};return e.createElement(e.Fragment,null,e.createElement("div",{className:"mb-10 flex flex-col overflow-hidden rounded-lg shadow-modal"},e.createElement("div",{className:"inline-block min-w-full align-middle"},e.createElement("div",{className:"divide-y divide-greyAlt/[.4] overflow-hidden rounded-lg border dark:divide-greyBase/[.4] dark:border-greyBase/[.4]"},e.createElement("div",{className:"px-4 py-3 lg:px-6 lg:py-5"},e.createElement("div",{className:"relative max-md:w-[254px] md:flex md:flex-row-reverse md:items-center md:justify-between"},n?e.createElement(T,{toggleModal:u=>o(u,!0,"clearLog")}):null,e.createElement("h3",{className:"mb-4 text-2xl font-medium text-darkBase dark:text-whiteBase"},"Deleted news"),e.createElement("div",null,e.createElement(R,{inputData:{name:"Deleted news",type:"text",value:m,placeholder:"Title"},hasIcon:!0,svgName:"search",onChange:u=>x(u),variant:$.FilterServiceBlock})))),e.createElement(q,{displayedRows:b}),e.createElement("div",{className:"flex justify-between px-4 lg:px-6"},e.createElement(J,{handlePageChange:d,currentPage:E,totalPages:g}),l?e.createElement("div",{className:"flex gap-x-7"},e.createElement(T,{toggleModal:u=>o(u,!0,"clearLog")})):null)))),r&&c==="clearLog"&&e.createElement(U,{closeModal:o,modalRef:i},e.createElement(F,{handleClose:u=>o(u),handleDelete:h,position:"clearLog",title:"Clear log",agreementText:"clear the log of deleted"})))},se=()=>{const{allArchive:a,archiveHistoryLog:s,getHistoryLog:t,getArchives:n}=S();f.useEffect(()=>{n(),t()},[n,t]);const l=z(a);return e.createElement(j,null,(s==null?void 0:s.length)>0?e.createElement(Z,{logData:s}):null,Object.entries(l).reverse().map(([r,c])=>e.createElement(O,{key:r,dateSeparator:r,position:"archivePage"},e.createElement(W,{currentItems:c}))))};export{se as default};

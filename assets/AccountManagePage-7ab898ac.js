import{F as E,G as B,I as b,J as y,K as A,e as h,k as x,N as I,O as S,Q as v,R as s,A as C,T,W as R,P as $,V as H,X as F}from"./index-c914540b.js";import{T as U}from"./Toast-de510eda.js";const M=({newPassword:t,confirmPassword:n,password:a,errors:e})=>{var l,o,c,u,m;const i=[{type:"password",placeholder:"Enter new password",fieldValue:t,errors:(l=e==null?void 0:e.newPassword)==null?void 0:l.message,label:"newPassword",ariaInvalid:!!(e!=null&&e.newPassword),iconName:"password"},{type:"password",placeholder:"Confirm new password",fieldValue:n,errors:(o=e==null?void 0:e.confirmPassword)==null?void 0:o.message,label:"confirmPassword",ariaInvalid:!!(e!=null&&e.confirmPassword),iconName:"password"}];return!!t&&!!n&&!((c=e==null?void 0:e.newPassword)!=null&&c.message)&&!((u=e==null?void 0:e.confirmPassword)!=null&&u.message)&&i.push({type:"password",placeholder:"Enter your current password",fieldValue:a,errors:(m=e==null?void 0:e.password)==null?void 0:m.message,label:"password",ariaInvalid:!!(e!=null&&e.password),iconName:"password"}),i},q=({email:t,password:n,errors:a})=>{var d,l,o;const e=[{type:"email",placeholder:"Enter new email",fieldValue:t,errors:(d=a==null?void 0:a.email)==null?void 0:d.message,label:"email",iconName:"envelop",ariaInvalid:!!(a!=null&&a.email),autofill:"email"}];return t&&!((l=a==null?void 0:a.email)!=null&&l.message)&&t.length!==0&&e.push({type:"password",placeholder:"Enter your current password",fieldValue:n,errors:(o=a==null?void 0:a.password)==null?void 0:o.message,label:"password",iconName:"password",ariaInvalid:!!(a!=null&&a.password)}),e},D=E({email:B(),password:b()}),G=E({newPassword:y(),confirmPassword:A(y()),password:b()}),L=()=>{const{updateEmail:t}=h(),{showToast:n}=x(),{handleSubmit:a,register:e,watch:i,reset:d,getValues:l,formState:{errors:o}}=I({resolver:S(D),defaultValues:{email:"",password:""}}),[c,u]=i(["email","password"]);return{emailSubmit:a,updateEmailRegister:e,errors:o,email:c,handleEmailSubmitHandler:async w=>{try{const r=await t(w);v(),n(r.meta.requestStatus)}catch(r){throw console.error("Error during updateEmail:",r),r}finally{d({...l,email:"",password:""})}},emailInputs:q({email:c,password:u,errors:o})}},O=()=>{const{updatePassword:t}=h(),{showToast:n}=x(),{handleSubmit:a,register:e,watch:i,reset:d,getValues:l,formState:{errors:o}}=I({resolver:S(G),defaultValues:{newPassword:"",confirmPassword:"",password:""}}),[c,u,m]=i(["newPassword","confirmPassword","password"]);return{passwordSubmit:a,updatePasswordRegister:e,handlePasswordSubmitHandler:async r=>{try{const{newPassword:p,password:g}=r,f=await t({password:g,newPassword:p});v(),n(f.meta.requestStatus)}catch(p){throw console.error("Error during updatePassword:",p),p}finally{d({...l,newPassword:"",confirmPassword:"",password:""})}},passwordInputs:M({newPassword:c,confirmPassword:u,password:m,errors:o})}},P=({field:t})=>{const{isRefreshingUser:n}=h(),{emailSubmit:a,updateEmailRegister:e,emailInputs:i,handleEmailSubmitHandler:d}=L(),{passwordSubmit:l,updatePasswordRegister:o,handlePasswordSubmitHandler:c,passwordInputs:u}=O(),m=t==="email"?i:u;let w="";switch(t){case"email":w="and confirm by inputting your current password in the new field.";break;case"password":w="in the first field and repeat the entry in the second field. In the third field, confirm the change by inputting your current password.";break}return s.createElement(C,{position:"accountManagePage",blockDefinition:`Change your ${t}`},s.createElement("form",{className:"space-y-4 pt-4 lg:space-y-8",onSubmit:t==="email"?a(d):l(c)},s.createElement("ul",{className:"space-y-4 lg:space-y-8"},Array.isArray(m)&&m.map(({label:r,type:p,placeholder:g,fieldValue:f,errors:N,iconName:k,ariaInvalid:V})=>s.createElement("li",{key:r},s.createElement(T,{inputData:{type:p,placeholder:g,fieldValue:f},errors:N,register:t==="email"?e:o,label:r,hasIcon:!0,svgName:k,variant:R.Account,ariaInvalid:V})))),s.createElement("p",{className:"text-small text-darkBase dark:text-whiteBase lg:text-medium hg:text-xl"},`To change your current ${t}, enter the new ${t} ${w} If all information is entered correctly, you will receive a
          notification confirming the successful update of your ${t}.`),s.createElement($,{type:"submit",width:"w-28 lg:w-40",id:`Button for applying change ${t==="password"?"and confirm ":""}your new ${t}`,variant:H.Other,disabled:!!(t==="email"&&n)},"Apply")))},J=()=>{const{authError:t,statusMessage:n}=h(),a=n==="Email is successfully updated"||n==="Password is successfully updated"||n.includes("linking"),e=a||typeof t=="string";return s.createElement("div",null,s.createElement("h2",{className:"mb-14 text-end text-3xl leading-tighter text-darkBase dark:text-whiteBase hg:text-5xl"},"Account settings"),s.createElement("div",{className:"flex items-center justify-end"},s.createElement("div",{className:"w-52 space-y-2 md:w-80 md:space-y-6 lg:w-600px"},s.createElement(s.Fragment,null,s.createElement(P,{field:"email"}),s.createElement(P,{field:"password"})),s.createElement("h3",{className:"text-darkBase dark:text-whiteBase md:text-2xl lg:mb-4 hg:text-3xl"},"Connected accounts"),s.createElement("p",{className:"text-small leading-normal text-darkBase dark:text-whiteBase lg:text-medium hg:text-xl"},"You can connect or disconnect your News account to Google, Facebook, or Apple to log in using this account. We will never send messages to your contacts without your permission."),s.createElement("hr",{className:"!border-greyAlt dark:!border-whiteBase"}),s.createElement(F,null))),e?s.createElement(U,{variant:"interactive",status:a?"success":"error"}):null)};export{J as default};

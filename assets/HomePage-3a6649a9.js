import{u as R,a as W,b as _,r as B,R as s,P,V as S,S as A,I as D,c as V,d as j,e as q,f as Q,g as U,h as Y,i as Z,L as G,N as L}from"./index-6fd93497.js";import{u as J}from"./useToast-1120f1b5.js";import{P as X,N as F}from"./NewsList-857f8111.js";import"./images-175067f1.js";const b=(n,e,i)=>{const c=[e];let r=n-e;for(;r>0;)c.push(i),r-=i;return c},M=(n,e)=>{const i=n&&n.slice(0,-1).reduce((r,f)=>r+f,0);return e-i},k=(n,e,i)=>b(n,e,i),ee=(n,e)=>{try{return M(n,e)}catch(i){return console.error(i.message)}},te=n=>{const{breakpointsForMarkup:e}=R()||{breakpointsForMarkup:null},{popularNews:i,newsByKeyword:c,newsByCategory:r,newsByDate:f}=W(),{filteredNews:E}=_(),[u,t]=B.useState(1),[g,a]=B.useState([]),m=n&&(n==null?void 0:n.length)||0,p=(e==null?void 0:e.isNothing)||(e==null?void 0:e.isMobile),o=C(),d=I(),v=k(m,o,d),h=v[u-1]||0,l=ee(v,m);B.useEffect(()=>{if(n&&(n==null?void 0:n.length)>0){const y=u*h-1>=m;let w,x;u===1?(w=u*h,x=w-h):u>1&&y&&l?(w=m,x=m-l):(w=u*h-1,x=w-h);const O=n.slice(x,w);a(O)}},[i,c,r,f,E,u]);function C(){return e!=null&&e.isNothing||e!=null&&e.isMobile?4:e!=null&&e.isTablet?7:8}function I(){return p?5:e!=null&&e.isTablet?8:9}const N=Math.ceil(u!==1&&p?m/h+1:m/h),T=Array.from({length:N},(y,w)=>w+1);return{currentItems:g,pageNumbers:T,currentPage:u,setCurrentPage:t}},H="w-32",se=({pageNumbers:n,currentPage:e,setCurrentPage:i})=>{const{breakpointsForMarkup:c}=R()??{breakpointsForMarkup:null},r=(c==null?void 0:c.isTablet)||(c==null?void 0:c.isDesktop),f=n.length,E=window.innerHeight,u=r?6:3,t=[],g=1,a=f,m=e-1,p=e+1,o=l=>s.createElement("li",{key:l,className:`${l===e?"active":""}`,onClick:()=>{i(l),window.scrollTo({top:0+E,left:0})}},s.createElement(P,{"aria-label":l.toString(),classNameButton:`h-10 border-accentBase font-medium transition-colors duration-500 ${l===e?"bg-accentBase text-contrastWhite":"text-darkBase dark:text-whiteBase dark:border-whiteBase"}`,variant:S.Small},l)),d=l=>s.createElement("li",{key:l,className:"ellipsis"},s.createElement("span",{className:"text-darkBase dark:text-whiteBase"},"..."));if(f<=u)for(let l=g;l<=a;l+=1)t.push(o(l));else e===g?(t.push(o(e)),t.push(o(p)),t.push(d("next")),t.push(o(a))):e===a?(t.push(o(g)),t.push(d("prev")),t.push(o(m)),t.push(o(e))):e>g&&e<a&&(e===2&&(t.push(d("prev")),t.push(o(e)),t.push(o(p)),t.push(d("next")),t.push(o(a))),e-1>g&&e+1!==a&&(t.push(d("prev")),t.push(o(m)),t.push(o(e)),t.push(o(p)),t.push(d("next"))),e+1===a&&(t.push(d("prev")),t.push(o(m)),t.push(o(e)),t.push(o(a))));const v=()=>{e>1&&(i(e-1),window.scrollTo({top:0+E,left:0}))},h=()=>{e<n.length&&(i(e+1),window.scrollTo({top:0+E,left:0}))};return s.createElement("div",{className:"flex items-center justify-center gap-2"},s.createElement(P,{id:"Previous page button",variant:S.Other,onHandleClick:v,width:H,disabled:e-1===0},s.createElement(A,{svgName:"icon-arrow-left",size:D.mdIcon24,className:"fill-whiteBase"}),r?s.createElement("span",{className:"text-base font-medium text-contrastWhite md:text-medium"},"Prev"):null),s.createElement("ul",{id:"page-numbers",className:"flex gap-2"},t),s.createElement(P,{id:"Next page button",variant:S.Other,onHandleClick:h,width:H,disabled:e===a},r?s.createElement("span",{className:"text-base font-medium text-contrastWhite md:text-medium"},"Next"):null,s.createElement(A,{svgName:"icon-arrow-left",size:D.mdIcon24,className:"rotate-180 fill-whiteBase"})))},ne="1",ce=()=>{const{isLoadingAPIData:n,errorAPI:e,headline:i,newsByCategory:c,newsByDate:r,newsByKeyword:f,fetchPopular:E}=W(),{isLoadingDBData:u,getSavedNews:t}=V(),{isAuthenticated:g,authError:a}=j(),{openToast:m,setOpenToast:p}=q(),{showErrorToast:o}=J(),d=Q(),v=U(d),{rebuildedNews:h}=Y({activeLinks:v}),{hasResults:l}=_(),{currentItems:C,currentPage:I,pageNumbers:N,setCurrentPage:T}=te(h??[]),y=e==null?void 0:e.toString().includes("429"),w=Z();B.useEffect(()=>{e&&e>=500&&w("/serverError")},[e]),B.useEffect(()=>{E(ne),g&&t()},[E,t,g]),B.useEffect(()=>{(f||c||r)&&p(!0)},[f,c,r]);const x=n||u||l==="loading",O=h&&h.length===0||l==="empty",$=f&&f.length>0||c&&c.length>0||r&&r.length>0,z=!x&&$,K=a&&a.message||e;return s.createElement(s.Fragment,null,x?s.createElement(G,{variant:"generalSection"}):s.createElement(s.Fragment,null,O||y?s.createElement(X,{variant:"page"}):s.createElement(s.Fragment,null,i&&s.createElement("h2",{className:"mb-6 text-giant font-bold dark:text-whiteBase"},i),s.createElement(F,{currentItems:C,currentPage:I}),s.createElement(se,{pageNumbers:N,currentPage:I,setCurrentPage:T}))),K&&s.createElement(L,{openToast:m,setOpenToast:p,title:`${a!=null&&a.message?"Authorisation error":"News API Error"}`,description:a!=null&&a.message||e?o():""}),z&&s.createElement(L,{variant:"non-interactive",openToast:m,setOpenToast:p,title:"Found news",description:`There are ${h.length} news has been found`}))};export{ce as default};

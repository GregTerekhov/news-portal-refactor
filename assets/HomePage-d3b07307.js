import{u as R,a as W,b as _,r as B,R as s,P,V as A,S as D,c as K,d as V,e as j,f as q,g as Q,h as U,L as Y,N as L}from"./index-98ff3bbc.js";import{u as Z}from"./useToast-c0c90347.js";import{P as G,N as J}from"./NewsList-0cabd41b.js";import"./images-92a6036b.js";const X=(n,e,i)=>{const c=[e];let r=n-e;for(;r>0;)c.push(i),r-=i;return c},F=(n,e)=>{const i=n&&n.slice(0,-1).reduce((r,f)=>r+f,0);return e-i},b=(n,e,i)=>X(n,e,i),M=(n,e)=>{try{return F(n,e)}catch(i){return console.error(i.message)}},k=n=>{const{breakpointsForMarkup:e}=R()||{breakpointsForMarkup:null},{popularNews:i,newsByKeyword:c,newsByCategory:r,newsByDate:f}=W(),{filteredNews:E}=_(),[u,t]=B.useState(1),[p,a]=B.useState([]),m=n&&(n==null?void 0:n.length)||0,w=(e==null?void 0:e.isNothing)||(e==null?void 0:e.isMobile),o=T(),d=y(),x=b(m,o,d),h=x[u-1]||0,l=M(x,m);B.useEffect(()=>{if(n&&(n==null?void 0:n.length)>0){const C=u*h-1>=m;let g,v;u===1?(g=u*h,v=g-h):u>1&&C&&l?(g=m,v=m-l):(g=u*h-1,v=g-h);const O=n.slice(v,g);a(O)}},[i,c,r,f,E,u]);function T(){return e!=null&&e.isNothing||e!=null&&e.isMobile?4:e!=null&&e.isTablet?7:8}function y(){return w?5:e!=null&&e.isTablet?8:9}const I=Math.ceil(u!==1&&w?m/h+1:m/h),N=Array.from({length:I},(C,g)=>g+1);return{currentItems:p,pageNumbers:N,currentPage:u,setCurrentPage:t}},S="w-32",H=24,ee=({pageNumbers:n,currentPage:e,setCurrentPage:i})=>{const{breakpointsForMarkup:c}=R()??{breakpointsForMarkup:null},r=(c==null?void 0:c.isTablet)||(c==null?void 0:c.isDesktop),f=n.length,E=window.innerHeight,u=r?6:3,t=[],p=1,a=f,m=e-1,w=e+1,o=l=>s.createElement("li",{key:l,className:`${l===e?"active":""}`,onClick:()=>{i(l),window.scrollTo({top:0+E,left:0})}},s.createElement(P,{"aria-label":l.toString(),classNameButton:`h-10 border-accentBase font-medium transition-colors duration-500 ${l===e?"bg-accentBase text-contrastWhite":"text-darkBase dark:text-whiteBase dark:border-whiteBase"}`,variant:A.Small},l)),d=l=>s.createElement("li",{key:l,className:"ellipsis"},s.createElement("span",{className:"text-darkBase dark:text-whiteBase"},"..."));if(f<=u)for(let l=p;l<=a;l+=1)t.push(o(l));else e===p?(t.push(o(e)),t.push(o(w)),t.push(d("next")),t.push(o(a))):e===a?(t.push(o(p)),t.push(d("prev")),t.push(o(m)),t.push(o(e))):e>p&&e<a&&(e===2&&(t.push(d("prev")),t.push(o(e)),t.push(o(w)),t.push(d("next")),t.push(o(a))),e-1>p&&e+1!==a&&(t.push(d("prev")),t.push(o(m)),t.push(o(e)),t.push(o(w)),t.push(d("next"))),e+1===a&&(t.push(d("prev")),t.push(o(m)),t.push(o(e)),t.push(o(a))));const x=()=>{e>1&&(i(e-1),window.scrollTo({top:0+E,left:0}))},h=()=>{e<n.length&&(i(e+1),window.scrollTo({top:0+E,left:0}))};return s.createElement("div",{className:"flex justify-center items-center gap-2"},s.createElement(P,{id:"Previous page button",variant:A.Other,onHandleClick:x,width:S,disabled:e-1===0},s.createElement(D,{svgName:"icon-arrow-left",size:H,className:"fill-whiteBase"}),r?s.createElement("span",{className:"text-base md:text-medium font-medium text-contrastWhite"},"Prev"):null),s.createElement("ul",{id:"page-numbers",className:"flex gap-2"},t),s.createElement(P,{id:"Next page button",variant:A.Other,onHandleClick:h,width:S,disabled:e===a},r?s.createElement("span",{className:"text-base md:text-medium font-medium text-contrastWhite"},"Next"):null,s.createElement(D,{svgName:"icon-arrow-left",size:H,className:"fill-whiteBase rotate-180"})))},te="1",ie=()=>{const{isLoadingAPIData:n,errorAPI:e,headline:i,newsByCategory:c,newsByDate:r,newsByKeyword:f,fetchPopular:E}=W(),{isLoadingDBData:u,getSavedNews:t}=K(),{isAuthenticated:p,authError:a}=V(),{openToast:m,setOpenToast:w}=j(),{showErrorToast:o}=Z(),d=q(),x=Q(d),{rebuildedNews:h}=U({activeLinks:x}),{hasResults:l}=_(),{currentItems:T,currentPage:y,pageNumbers:I,setCurrentPage:N}=k(h??[]),C=e==null?void 0:e.toString().includes("429");B.useEffect(()=>{E(te),p&&t()},[E,t,p]),B.useEffect(()=>{(f||c||r)&&w(!0)},[f,c,r]);const g=n||u||l==="loading",v=h&&h.length===0||l==="empty",O=f&&f.length>0||c&&c.length>0||r&&r.length>0,$=!g&&O,z=a&&a.message||e;return s.createElement(s.Fragment,null,g?s.createElement(Y,{variant:"generalSection"}):s.createElement(s.Fragment,null,v||C?s.createElement(G,{variant:"page"}):s.createElement(s.Fragment,null,i&&s.createElement("h2",{className:"mb-6 text-giant font-bold dark:text-whiteBase"},i),s.createElement(J,{currentItems:T,currentPage:y}),s.createElement(ee,{pageNumbers:I,currentPage:y,setCurrentPage:N}))),z&&s.createElement(L,{openToast:m,setOpenToast:w,title:`${a!=null&&a.message?"Authorisation error":"News API Error"}`,description:a!=null&&a.message||e?o():""}),$&&s.createElement(L,{variant:"non-interactive",openToast:m,setOpenToast:w,title:"Found news",description:`There are ${h.length} news has been found`}))};export{ie as default};

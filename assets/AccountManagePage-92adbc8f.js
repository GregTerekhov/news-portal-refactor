import{v as b,w as C,x as v,y as T,z as q,d as h,e as y,B as S,C as x,R as s,A as N,D as V,E as A,P as B,V as k,F as U,N as D}from"./index-599f9c23.js";import{u as O}from"./useToast-e1f39563.js";const H=({newPassword:t,confirmPassword:n,password:a,errors:e})=>{var i,l,d,u,r;const o=[{placeholder:"Enter new password",fieldValue:t,errors:(i=e==null?void 0:e.newPassword)==null?void 0:i.message,label:"newPassword",ariaInvalid:!!(e!=null&&e.newPassword)},{placeholder:"Confirm new password",fieldValue:n,errors:(l=e==null?void 0:e.confirmPassword)==null?void 0:l.message,label:"confirmPassword",ariaInvalid:!!(e!=null&&e.confirmPassword)}];return t&&n&&!((d=e==null?void 0:e.newPassword)!=null&&d.message)&&!((u=e==null?void 0:e.confirmPassword)!=null&&u.message)&&t.length!==0&&n.length!==0&&o.push({placeholder:"Enter your current password",fieldValue:a,errors:(r=e==null?void 0:e.password)==null?void 0:r.message,label:"password",ariaInvalid:!!(e&&(e!=null&&e.password))}),o},M=({email:t,password:n,errors:a})=>{var c,i,l;const e=[{type:"email",placeholder:"Enter new email",fieldValue:t,errors:(c=a==null?void 0:a.email)==null?void 0:c.message,label:"email",iconName:"icon-envelop",ariaInvalid:!!(a!=null&&a.email)}];return t&&!((i=a==null?void 0:a.email)!=null&&i.message)&&t.length!==0&&e.push({type:"password",placeholder:"Enter your current password",fieldValue:n,errors:(l=a==null?void 0:a.password)==null?void 0:l.message,label:"password",iconName:"icon-envelop",ariaInvalid:!!(a!=null&&a.password)}),e},j=b({email:C(),password:v()}),R=b({newPassword:T(),confirmPassword:q().required("Confirm password is required").test("passwords-match","Passwords do not match",function(t){return t===this.parent.newPassword}).trim(),password:v()}),F=()=>{const{updateEmail:t}=h(),{setOpenToast:n}=y(),{handleSubmit:a,register:e,watch:o,reset:c,getValues:i,formState:{errors:l}}=S({resolver:x(j),defaultValues:{email:"",password:""}}),[d,u]=o(["email","password"]),r=async g=>{try{const m=await t(g),{code:p,message:f}=m.payload;if(console.log("requestStatus",m.meta.requestStatus),m.meta.requestStatus==="rejected"){n(!0);return}p&&p===200&&f&&f==="Email is successfully updated"&&n(!0)}catch(m){console.error("Error during updateEmail:",m)}c({...i,email:"",password:""})},w=M({email:d,password:u,errors:l});return{handleSubmit:a,register:e,errors:l,email:d,handleEmailSubmitHandler:r,emailInputs:w}},$=()=>{const{updatePassword:t}=h(),{setOpenToast:n}=y(),{handleSubmit:a,register:e,watch:o,reset:c,getValues:i,formState:{errors:l}}=S({resolver:x(R),defaultValues:{newPassword:"",confirmPassword:"",password:""}}),[d,u,r]=o(["newPassword","confirmPassword","password"]),w=async m=>{try{const{newPassword:p,password:f}=m,P=await t({password:f,newPassword:p}),{code:E,message:I}=P.payload;if(P.meta.requestStatus==="rejected"){n(!0);return}E&&E===200&&I&&I==="Password is successfully updated"&&n(!0)}catch(p){console.error("Error during updatePassword:",p)}c({...i,newPassword:"",confirmPassword:"",password:""})},g=H({newPassword:d,confirmPassword:u,password:r,errors:l});return{handleSubmit:a,register:e,handlePasswordSubmitHandler:w,passwordInputs:g}},z=({})=>{const{isRefreshingUser:t}=h(),{handleSubmit:n,register:a,emailInputs:e,handleEmailSubmitHandler:o}=F();return s.createElement(N,{position:"accountManagePage",filtersBlock:"Change your email"},s.createElement("form",{className:"pt-4 space-y-4 lg:space-y-8",onSubmit:n(o)},s.createElement("ul",{className:"space-y-4 lg:space-y-8"},Array.isArray(e)&&e.map(({type:c,placeholder:i,fieldValue:l,errors:d,label:u,iconName:r,ariaInvalid:w})=>s.createElement("li",{key:u},s.createElement(V,{inputData:{type:c,placeholder:i,fieldValue:l},errors:d,register:a,label:u,svgName:r,className:"fill-accentBase",hasIcon:!0,variant:A.Account,ariaInvalid:w})))),s.createElement("p",{className:" text-darkBase text-small lg:text-medium dark:text-whiteBase"},"To change your current email, enter the new email and confirm by inputting your current password in the new field. If all information is entered correctly, you will receive a notification confirming the successful update of your email."),s.createElement(B,{buttonData:{type:"submit"},width:"w-28 lg:w-40",id:"Button for applying change your email ",variant:k.Other,disabled:!!t},"Apply")))},L=()=>{const{handleSubmit:t,register:n,handlePasswordSubmitHandler:a,passwordInputs:e}=$();return s.createElement(N,{position:"accountManagePage",filtersBlock:"Change your password"},s.createElement("form",{className:"pt-4 space-y-4 lg:space-y-8",onSubmit:t(a)},s.createElement("ul",{className:"space-y-4 lg:space-y-8"},Array.isArray(e)&&e.map(({placeholder:o,fieldValue:c,errors:i,label:l,ariaInvalid:d})=>s.createElement("li",{key:l},s.createElement(V,{inputData:{type:"password",placeholder:o,fieldValue:c},errors:i,register:n,label:l,svgName:"icon-password",hasIcon:!0,variant:A.Account,ariaInvalid:d})))),s.createElement("p",{className:" text-darkBase text-small lg:text-medium dark:text-whiteBase"},"To change your current password, enter the new password in the first field and repeat the entry in the second field. In the third field, confirm the change by inputting your current password. If all information is entered correctly, you will receive a notification confirming the successful update of your password."),s.createElement(B,{buttonData:{type:"submit"},width:"w-28 lg:w-40",id:"Button for applying change and confirm your new password",variant:k.Other},"Apply")))},Q=()=>{const{authError:t,statusMessage:n}=h(),{openToast:a,setOpenToast:e}=y(),{showErrorToast:o}=O();return s.createElement("div",null,s.createElement("h2",{className:"text-darkBase dark:text-whiteBase text-3xl leading-tighter text-end mb-14"},"Account settings"),s.createElement("div",{className:"flex items-center justify-end"},s.createElement("div",{className:"space-y-2 md:space-y-6 w-52 md:w-80 lg:w-[600px]"},s.createElement(z,null),s.createElement(L,null),s.createElement(U,null))),s.createElement(D,{openToast:a,setOpenToast:e,title:t!=null&&t.message?"Authorisation error":"Update credentials",description:t!=null&&t.message?o():n}))};export{Q as default};

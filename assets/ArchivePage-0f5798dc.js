import{B,I as C,l as L,f as S,u as T,S as $,R as e,m as O,c as W,C as F,n as j,r as f,o as G,p as V,q,M as D,U as z,s as K,t as X,v as Y,w as H,D as J,A as Q,k as Z}from"./index-bbedbc49.js";import{D as P,P as ee,N as te}from"./PageTemplate-899fb8b8.js";import{P as y}from"./pagination-b5779b30.js";import"./Toast-9151dc6f.js";const R=[{label:"Title"},{label:"Category"},{label:"Addition Date"},{label:"Deletion Date"}],ae=(a,s)=>[{type:B.Submit,iconName:C.Reset,label:"Update log",disabled:a},{type:B.Button,iconName:C.Trash,label:"Clear log",disabled:s}],se=56,ne=87,le=a=>{const s={};return(a==null?void 0:a.length)>0&&a.forEach(t=>{const n=t==null?void 0:t.additionDate;if(n){const{fullMonthYear:l}=L(n);s[l]||(s[l]=[]),s[l].push(t)}}),s},oe=(a,s)=>{let t;switch(!0){case s:t=ne;break;default:t=se;break}return a.length>t?`${a.slice(0,t)}...`:a},re=(a,s)=>`${s?"text-greyAlt dark:text-greyBase":"text-accentBase hocus:text-accentAlt dark:text-whiteBase dark:hocus:text-accentBase"} ${a==="reset"?"max-md:right-12":"max-md:right-0"} group flex items-center gap-x-4 transition-colors duration-500 max-md:absolute max-md:top-0 max-md:h-10 max-md:w-10 max-md:justify-center`,ce=a=>`${a?"fill-greyAlt dark:fill-greyBase":"fill-accentBase group-hover:fill-accentAlt group-focus:fill-accentAlt dark:fill-whiteBase dark:group-hover:fill-accentBase dark:group-focus:fill-accentBase"}`,_=({toggleModal:a})=>{const{getHistoryLog:s,dbSuccessMessage:t,archiveHistoryLog:n}=S(),{isNotMobile:l}=T(),o=t!==$.DeleteNews,c=(n==null?void 0:n.length)===0,i=ae(o,c);return e.createElement(e.Fragment,null,Array.isArray(i)&&i.map(({type:d,iconName:r,label:h,disabled:p})=>e.createElement(e.Fragment,{key:r},e.createElement("button",{type:d,disabled:p,onClick:d===B.Button?a:s,className:re(r,p)},l?h:null,e.createElement(O,{svgName:r,sizeKey:W.smIcon18,className:ce(p)})))))},ie=({displayedRows:a})=>{const{isWideScreens:s}=T(),t="whitespace-nowrap px-6 text-small font-medium text-darkBase dark:text-whiteBase lg:text-medium group-hover:text-whiteBase transition-colors duration-500";return e.createElement(F,{isOpen:!0,orientation:j.Horisontal},e.createElement("table",{className:"mb-2.5 min-w-full divide-y divide-greyAlt/[.4] transition-colors duration-500 dark:divide-greyBase/[.4]"},e.createElement("thead",{className:"bg-accentBase/[.2] transition-colors duration-500 dark:bg-greyBase/[.4]"},e.createElement("tr",null,Array.isArray(R)&&R.map(({label:n})=>e.createElement("th",{key:n,scope:"col",className:"px-6 py-3 text-start text-xs font-medium uppercase text-greyBase transition-colors duration-500 dark:text-whiteBase md:text-small lg:text-xl"},n)))),e.createElement("tbody",{className:"divide-y divide-whiteBase transition-colors duration-500 dark:divide-gray-700"},Array.isArray(a)&&a.map(({title:n,newsUrl:l,category:o,additionDate:c,deletionDate:i})=>e.createElement("tr",{key:l,className:"group transition-colors duration-500 even:bg-greyAlt/[.1] hover:bg-accentBase/65"},e.createElement("td",{className:t},e.createElement("a",{href:l,target:"_blank",rel:"noopener noreferrer nofollow",className:"block py-4 lg:text-medium"},oe(n,s))),e.createElement("td",{className:t},o),e.createElement("td",{className:t},L(c).dayMonthYear),e.createElement("td",{className:t},L(i).dayMonthYear))))))},U=({handlePageChange:a,currentPage:s,label:t,position:n,iconClass:l})=>{const{archiveHistoryLog:o}=S(),c=n<s,i=s===n||(o==null?void 0:o.length)===0,d="group inline-flex items-center gap-x-2 rounded-full p-2.5 transition-colors duration-500 hocus:bg-accentBase disabled:pointer-events-none disabled:opacity-50 dark:hocus:bg-accentBase dark:focus:outline-none dark:focus:ring-1 dark:focus:ring-gray-600";return e.createElement("button",{type:B.Button,onClick:()=>a(c?s-1:s+1),disabled:i,className:d},e.createElement("span",{"aria-hidden":"true"},e.createElement(O,{svgName:C.Arrow,sizeKey:W.xsIcon14,className:`${l} fill-accentBase group-hover:fill-whiteBase group-focus:fill-whiteBase dark:fill-whiteBase`})),e.createElement("span",{className:"sr-only"},t))},de=4,me=5,k=2,w=3,E=1,ue=({currentPage:a,handlePageChange:s,totalPages:t})=>{const{isSmallScreens:n}=T(),l=()=>{const c=[],i=(g,m)=>g===m?"bg-accentBase text-whiteBase":"bg-transparent text-darkBase dark:text-whiteBase",d=(g,m)=>{for(let x=g;x<=m;x+=E)c.push(e.createElement("button",{key:x,type:B.Button,"aria-current":"page",className:`${o} ${i(a,x)}`,onClick:()=>s(x)},x))},r=g=>{c.push(e.createElement("span",{key:`dots ${g}`,className:"flex w-10 items-center justify-center text-darkBase dark:text-whiteBase"},"..."))},h=()=>{c.push(e.createElement("button",{key:t,type:B.Button,"aria-current":"page",className:`${o} ${i(a,t)}`,onClick:()=>s(t)},t))},p=a+k===t||a+E===t||a===t,b=a+w===t||a+k===t||a+E===t||a===t,u=t<=de,N=t<=me,M=a===E,A=a+(n?k:w)<t;switch(!0){case(u||N):d(E,t);break;case M:d(E,n?k:w),r(y.Next),h();break;case(p&&n):r(y.Previous),d(t-k,t);break;case(b&&!n):r(y.Previous),d(t-w,t);break;case(A&&n):r(y.Previous),d(a,a+(n?0:E)),r(y.Next),h();break}return c},o="flex w-10 h-10 items-center justify-center rounded-full py-2.5 text-small text-darkBase transition-colors duration-500 hocus:bg-accentBase hocus:text-whiteBase dark:text-whiteBase dark:hocus:bg-accentBase lg:text-medium";return e.createElement(e.Fragment,null,l())},pe=({handlePageChange:a,currentPage:s,totalPages:t})=>e.createElement("nav",{className:"flex items-center space-x-1 py-2"},e.createElement(U,{handlePageChange:a,currentPage:s,label:"Previous",position:1,iconClass:"rotate-90"}),e.createElement(ue,{currentPage:s,totalPages:t,handlePageChange:a}),e.createElement(U,{handlePageChange:a,currentPage:s,label:"Next",position:t,iconClass:"-rotate-90"})),v=1,I=7,he=a=>{const[s,t]=f.useState(""),[n,l]=f.useState(v),o=f.useMemo(()=>s?a.filter(u=>u.title.toLowerCase().includes(s.toLowerCase())):a,[a,s]),c=o.length,i=Math.ceil(c/I),d=(n-v)*I,r=d+I,h=o.slice(d,r),p=f.useCallback(u=>{const N=u.target.value;t(N),l(v)},[]),b=f.useCallback(u=>{u>=v&&u<=i&&l(u)},[i]);return{searchValue:s,currentPage:n,totalPages:i,displayedRows:h,handleSearchNews:p,handlePageChange:b}},ge=({logData:a})=>{const{requestStatus:s,clearLog:t,archiveHistoryLog:n}=S(),{showToast:l}=G(),{isSmallScreens:o,isNotMobile:c}=T(),{isOpenModal:i,modalType:d}=V(),{toggleModal:r,popUpRef:h}=q(),{searchValue:p,currentPage:b,totalPages:u,displayedRows:N,handlePageChange:M,handleSearchNews:A}=he(a),g=async()=>{try{await t(),s&&l(s)}catch(m){throw console.error("Error during clearLog:",m),m}r()};return e.createElement(e.Fragment,null,e.createElement("div",{className:`${(n==null?void 0:n.length)===0?"mb-5":"mb-10"} flex flex-col overflow-hidden rounded-lg shadow-modal`},e.createElement("div",{className:"inline-block min-w-full align-middle"},e.createElement("div",{className:"divide-y divide-greyAlt/[.4] overflow-hidden rounded-lg border dark:divide-greyBase/[.4] dark:border-greyBase/[.4]"},e.createElement("div",{className:"px-4 py-3 lg:px-6 lg:py-5"},e.createElement("div",{className:"relative max-md:w-[254px] md:flex md:flex-row-reverse md:items-center md:justify-between"},o?e.createElement(_,{toggleModal:m=>r(m,!0,D.ClearLog)}):null,e.createElement("h3",{className:"mb-4 text-2xl font-medium text-darkBase dark:text-whiteBase"},"Deleted news"),(n==null?void 0:n.length)>0?e.createElement("div",null,e.createElement(z,{inputData:{name:K.DeletedNews,type:X.Text,value:p,placeholder:Y.FilterByTitle},hasIcon:!0,svgName:C.Search,onChange:m=>A(m)})):null)),e.createElement(ie,{displayedRows:N}),e.createElement("div",{className:"flex justify-between px-4 lg:px-6"},e.createElement(pe,{handlePageChange:M,currentPage:b,totalPages:u}),c?e.createElement("div",{className:"flex gap-x-7"},e.createElement(_,{toggleModal:m=>r(m,!0,D.ClearLog)})):null)))),i&&d===D.ClearLog&&e.createElement(H,{closeModal:r,modalRef:h},e.createElement(P,{handleClose:m=>r(m),handleDelete:g,title:J.Clear})))},be=()=>{const{allArchive:a,archiveHistoryLog:s,getHistoryLog:t,getArchives:n}=S();f.useEffect(()=>{n(),t()},[n,t]);const l=le(a);return e.createElement(ee,null,e.createElement(ge,{logData:s}),(s==null?void 0:s.length)===0?e.createElement("p",{className:"mb-5 text-right text-darkBase dark:text-whiteBase"},"This log will include your deleted news"):null,Object.entries(l).reverse().map(([o,c])=>e.createElement(Q,{key:o,dateSeparator:o,position:Z.Archive},e.createElement(te,{currentItems:c}))))};export{be as default};

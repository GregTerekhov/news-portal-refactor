import{u as R,a as W,b as $,r as C,R as s,P as A,V as L,S,c as q,d as z,e as K,f as V,g as j,h as Q,i as U,s as Z,L as G,N as O}from"./index-8e48dfbc.js";import{u as J}from"./useToast-2d0888d4.js";import{P as X,N as Y}from"./NewsList-24095a5b.js";import"./images-697e95be.js";const F=(n,e,a)=>{const i=[e];let m=n-e;for(;m>0;)i.push(a),m-=a;return i},b=(n,e)=>{const a=n&&n.slice(0,-1).reduce((m,p)=>m+p,0);return e-a},k=(n,e,a)=>F(n,e,a),M=(n,e)=>{try{return b(n,e)}catch(a){return console.error(a.message)}},ee=n=>{const{breakpointsForMarkup:e}=R()||{breakpointsForMarkup:null},{popularNews:a,newsByKeyword:i,newsByCategory:m,newsByDate:p}=W(),{filteredNews:E}=$(),[u,t]=C.useState(1),[c,h]=C.useState([]),r=n&&(n==null?void 0:n.length)||0,x=(e==null?void 0:e.isNothing)||(e==null?void 0:e.isMobile),o=I(),d=T(),w=k(r,o,d),f=w[u-1]||0,l=M(w,r);C.useEffect(()=>{if(n&&(n==null?void 0:n.length)>0){const y=u*f-1>=r;let g,v;u===1?(g=u*f,v=g-f):u>1&&y&&l?(g=r,v=r-l):(g=u*f-1,v=g-f);const P=n.slice(v,g);h(P)}},[a,i,m,p,E,u]);function I(){return e!=null&&e.isNothing||e!=null&&e.isMobile?4:e!=null&&e.isTablet?7:8}function T(){return x?5:e!=null&&e.isTablet?8:9}const N=Math.ceil(u!==1&&x?r/f+1:r/f),B=Array.from({length:N},(y,g)=>g+1);return{currentItems:c,pageNumbers:B,currentPage:u,setCurrentPage:t}},D="w-32",H=24,te=({pageNumbers:n,currentPage:e,setCurrentPage:a})=>{const{breakpointsForMarkup:i}=R()??{breakpointsForMarkup:null},m=(i==null?void 0:i.isTablet)||(i==null?void 0:i.isDesktop),p=n.length,E=window.innerHeight,u=m?6:3,t=[],c=1,h=p,r=e-1,x=e+1,o=l=>s.createElement("li",{key:l,className:`${l===e?"active":""}`,onClick:()=>{a(l),window.scrollTo({top:0+E,left:0})}},s.createElement(A,{"aria-label":l.toString(),classNameButton:`h-10 border-accentBase font-medium transition-colors duration-500 ${l===e?"bg-accentBase text-contrastWhite":"text-darkBase dark:text-whiteBase dark:border-whiteBase"}`,variant:L.Small},l)),d=l=>s.createElement("li",{key:l,className:"ellipsis"},s.createElement("span",{className:"text-darkBase dark:text-whiteBase"},"..."));if(p<=u)for(let l=c;l<=h;l+=1)t.push(o(l));else e===c?(t.push(o(e)),t.push(o(x)),t.push(d("next")),t.push(o(h))):e===h?(t.push(o(c)),t.push(d("prev")),t.push(o(r)),t.push(o(e))):e>c&&e<h&&(e===2&&(t.push(d("prev")),t.push(o(e)),t.push(o(x)),t.push(d("next")),t.push(o(h))),e-1>c&&e+1!==h&&(t.push(d("prev")),t.push(o(r)),t.push(o(e)),t.push(o(x)),t.push(d("next"))),e+1===h&&(t.push(d("prev")),t.push(o(r)),t.push(o(e)),t.push(o(h))));const w=()=>{e>1&&(a(e-1),window.scrollTo({top:0+E,left:0}))},f=()=>{e<n.length&&(a(e+1),window.scrollTo({top:0+E,left:0}))};return s.createElement("div",{className:"flex justify-center items-center gap-2"},s.createElement(A,{id:"Previous page button",variant:L.Other,onHandleClick:w,width:D,disabled:e-1===0},s.createElement(S,{svgName:"icon-arrow-left",size:H,className:"fill-whiteBase"}),m?s.createElement("span",{className:"text-base md:text-medium font-medium text-contrastWhite"},"Prev"):null),s.createElement("ul",{id:"page-numbers",className:"flex gap-2"},t),s.createElement(A,{id:"Next page button",variant:L.Other,onHandleClick:f,width:D,disabled:e===h},m?s.createElement("span",{className:"text-base md:text-medium font-medium text-contrastWhite"},"Next"):null,s.createElement(S,{svgName:"icon-arrow-left",size:H,className:"fill-whiteBase rotate-180"})))},ie=()=>{const{isLoadingAPIData:n,headline:e,newsByCategory:a,newsByDate:i,newsByKeyword:m,fetchPopular:p}=W(),{isLoadingDBData:E,getSavedNews:u}=q(),{isAuthenticated:t,authError:c}=z(),{openToast:h,setOpenToast:r}=K(),{showErrorToast:x}=J(),o=V(),d=j(o),{rebuildedNews:w}=Q({activeLinks:d}),{hasResults:f}=$(),{currentItems:l,currentPage:I,pageNumbers:T,setCurrentPage:N}=ee(w??[]),B=U(Z),y=B==null?void 0:B.toString().includes("429");C.useEffect(()=>{p("1"),t&&u()},[p,u,t]),C.useEffect(()=>{(m||a||i)&&r(!0)},[m,a,i]);const g=n||E||f==="loading",v=w&&w.length===0||f==="empty",P=m&&m.length>0||a&&a.length>0||i&&i.length>0,_=!g&&P;return s.createElement(s.Fragment,null,g?s.createElement(G,{variant:"generalSection"}):s.createElement(s.Fragment,null,v||y?s.createElement(X,{variant:"page"}):s.createElement(s.Fragment,null,e&&s.createElement("h2",{className:"dark:text-whiteBase text-giant font-bold mb-6"},e),s.createElement(Y,{currentItems:l,currentPage:I}),s.createElement(te,{pageNumbers:T,currentPage:I,setCurrentPage:N}))),c&&c.message&&s.createElement(O,{openToast:h,setOpenToast:r,title:`${(c==null?void 0:c.message)&&"Authorisation error"}`,description:c!=null&&c.message?x():""}),y&&s.createElement(O,{openToast:h,setOpenToast:r,title:"429",description:"Too many requests"}),_&&s.createElement(O,{variant:"non-interactive",openToast:h,setOpenToast:r,title:"Found news",description:`There are ${w.length} news has been found`}))};export{ie as default};

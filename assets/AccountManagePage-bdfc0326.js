import{x as I,y as T,z as b,B as P,D as A,e as g,s as S,E as v,F as N,R as s,A as C,G as $,I as R,P as M,V as U,J as D}from"./index-f7614949.js";import{T as F}from"./Toast-4dcfa68a.js";const H=({newPassword:a,confirmPassword:n,password:t,errors:e})=>{var i,o,d,m,r;const c=[{type:"password",placeholder:"Enter new password",fieldValue:a,errors:(i=e==null?void 0:e.newPassword)==null?void 0:i.message,label:"newPassword",ariaInvalid:!!(e!=null&&e.newPassword),iconName:"password"},{type:"password",placeholder:"Confirm new password",fieldValue:n,errors:(o=e==null?void 0:e.confirmPassword)==null?void 0:o.message,label:"confirmPassword",ariaInvalid:!!(e!=null&&e.confirmPassword),iconName:"password"}];return a&&n&&!((d=e==null?void 0:e.newPassword)!=null&&d.message)&&!((m=e==null?void 0:e.confirmPassword)!=null&&m.message)&&a.length!==0&&n.length!==0&&c.push({type:"password",placeholder:"Enter your current password",fieldValue:t,errors:(r=e==null?void 0:e.password)==null?void 0:r.message,label:"password",ariaInvalid:!!(e&&(e!=null&&e.password)),iconName:"password"}),c},q=({email:a,password:n,errors:t})=>{var l,i,o;const e=[{type:"email",placeholder:"Enter new email",fieldValue:a,errors:(l=t==null?void 0:t.email)==null?void 0:l.message,label:"email",iconName:"envelop",ariaInvalid:!!(t!=null&&t.email),autofill:"email"}];return a&&!((i=t==null?void 0:t.email)!=null&&i.message)&&a.length!==0&&e.push({type:"password",placeholder:"Enter your current password",fieldValue:n,errors:(o=t==null?void 0:t.password)==null?void 0:o.message,label:"password",iconName:"password",ariaInvalid:!!(t!=null&&t.password)}),e},G=I({email:T(),password:b()}),j=I({newPassword:P(),confirmPassword:A(P()),password:b()}),z=()=>{const{updateEmail:a}=g(),{showToast:n}=S(),{handleSubmit:t,register:e,watch:c,reset:l,getValues:i,formState:{errors:o}}=v({resolver:N(G),defaultValues:{email:"",password:""}}),[d,m]=c(["email","password"]),r=async h=>{try{const u=await a(h);localStorage.removeItem("rememberMe"),localStorage.removeItem("userId"),n(u.meta.requestStatus)}catch(u){console.error("Error during updateEmail:",u)}finally{l({...i,email:"",password:""})}},w=q({email:d,password:m,errors:o});return{emailSubmit:t,updateEmailRegister:e,errors:o,email:d,handleEmailSubmitHandler:r,emailInputs:w}},J=()=>{const{updatePassword:a}=g(),{showToast:n}=S(),{handleSubmit:t,register:e,watch:c,reset:l,getValues:i,formState:{errors:o}}=v({resolver:N(j),defaultValues:{newPassword:"",confirmPassword:"",password:""}}),[d,m,r]=c(["newPassword","confirmPassword","password"]),w=async u=>{try{const{newPassword:p,password:f}=u,y=await a({password:f,newPassword:p});localStorage.removeItem("rememberMe"),localStorage.removeItem("userId"),n(y.meta.requestStatus)}catch(p){console.error("Error during updatePassword:",p)}finally{l({...i,newPassword:"",confirmPassword:"",password:""})}},h=H({newPassword:d,confirmPassword:m,password:r,errors:o});return{passwordSubmit:t,updatePasswordRegister:e,handlePasswordSubmitHandler:w,passwordInputs:h}},x=({field:a})=>{const{isRefreshingUser:n}=g(),{emailSubmit:t,updateEmailRegister:e,emailInputs:c,handleEmailSubmitHandler:l}=z(),{passwordSubmit:i,updatePasswordRegister:o,handlePasswordSubmitHandler:d,passwordInputs:m}=J(),r=a==="email"?c:m,w=`and confirm by inputting your current
          ${a} in the new field.`,h=`in the first field and repeat the
          entry in the second field. In the third field, confirm the change by inputting your current ${a}.`,u=a==="email"?w:h;return s.createElement(C,{position:"accountManagePage",filtersBlock:`Change your email ${a}`},s.createElement("form",{className:"space-y-4 pt-4 lg:space-y-8",onSubmit:a==="email"?t(l):i(d)},s.createElement("ul",{className:"space-y-4 lg:space-y-8"},Array.isArray(r)&&r.map(({label:p,type:f,placeholder:E,fieldValue:y,errors:V,iconName:B,ariaInvalid:k})=>s.createElement("li",{key:p},s.createElement($,{inputData:{type:f,placeholder:E,fieldValue:y},errors:V,register:a==="email"?e:o,label:p,svgName:B,hasIcon:!0,variant:R.Account,ariaInvalid:k})))),s.createElement("p",{className:"text-small text-darkBase dark:text-whiteBase lg:text-medium hg:text-xl"},`To change your current ${a}, enter the new ${a} ${u} If all information is entered correctly, you will receive a
          notification confirming the successful update of your ${a}.`),s.createElement(M,{type:"submit",width:"w-28 lg:w-40",id:`Button for applying change ${a==="password"?"and confirm ":""}your new ${a}`,variant:U.Other,disabled:!!(a==="email"&&n)},"Apply")))},W=()=>{const{authError:a,statusMessage:n,isThirdPartyRegister:t}=g(),e=n==="Email is successfully updated"||n==="Password is successfully updated"||n.includes("linking"),l=e||a&&typeof a=="string";return s.createElement("div",null,s.createElement("h2",{className:"mb-14 text-end text-3xl leading-tighter text-darkBase dark:text-whiteBase hg:text-5xl"},"Account settings"),s.createElement("div",{className:"flex items-center justify-end"},s.createElement("div",{className:"w-52 space-y-2 md:w-80 md:space-y-6 lg:w-600px"},!t&&s.createElement(s.Fragment,null,s.createElement(x,{field:"email"}),s.createElement(x,{field:"password"})),s.createElement("h3",{className:"text-darkBase dark:text-whiteBase md:text-2xl lg:mb-4 hg:text-3xl"},"Connected accounts"),s.createElement("p",{className:"text-small leading-normal text-darkBase dark:text-whiteBase lg:text-medium hg:text-xl"},"You can connect or disconnect your News account to Google, Facebook, or Apple to log in using this account. We will never send messages to your contacts without your permission."),s.createElement("hr",{className:"!border-greyAlt dark:!border-whiteBase"}),s.createElement(D,null))),l?s.createElement(F,{variant:"interactive",status:e?"success":"error"}):null)};export{W as default};

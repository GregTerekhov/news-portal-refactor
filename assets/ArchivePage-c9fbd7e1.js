import{j as C,d as k,b as w,R as t,S as D,C as I,r as g,k as _,l as R,m as L,U,n as O,M as $,A as F}from"./index-c914540b.js";import{D as W,P as j,N as G}from"./PageTemplate-d3c22dfd.js";import"./images-92ff7b35.js";import"./Toast-de510eda.js";const S=[{label:"Title"},{label:"Category"},{label:"Addition Date"},{label:"Deletion Date"}],V=(a,s)=>[{type:"submit",iconName:"reset",label:"Update log",disabled:a},{type:"button",iconName:"trash",label:"Clear log",disabled:s}],z=56,q=87,K=a=>{const s={};return(a==null?void 0:a.length)>0&&a.forEach(e=>{const n=e==null?void 0:e.additionDate;if(n){const{fullMonthYear:o}=C(n);s[o]||(s[o]=[]),s[o].push(e)}}),s},X=(a,s)=>{let e;switch(!0){case s:e=q;break;default:e=z;break}return a.length>e?`${a.slice(0,e)}...`:a},Y=(a,s)=>`${s?"text-greyAlt dark:text-greyBase":"text-accentBase hocus:text-accentAlt dark:text-whiteBase dark:hocus:text-accentBase"} ${a==="reset"?"max-md:right-12":"max-md:right-0"} group flex items-center gap-x-4 transition-colors duration-500 max-md:absolute max-md:top-0 max-md:h-10 max-md:w-10 max-md:justify-center`,H=a=>`${a?"fill-greyAlt dark:fill-greyBase":"fill-accentBase group-hover:fill-accentAlt group-focus:fill-accentAlt dark:fill-whiteBase dark:group-hover:fill-accentBase dark:group-focus:fill-accentBase"}`,T=({toggleModal:a})=>{const{getHistoryLog:s,dbSuccessMessage:e,archiveHistoryLog:n}=k(),{isNotMobile:o}=w(),r=e!=="Remove news success",c=(n==null?void 0:n.length)===0,d=V(r,c);return t.createElement(t.Fragment,null,Array.isArray(d)&&d.map(({type:l,iconName:i,label:p,disabled:E})=>t.createElement(t.Fragment,{key:i},t.createElement("button",{type:l,disabled:E,onClick:l==="button"?a:s,className:Y(i,E)},o?p:null,t.createElement(D,{svgName:i,sizeKey:"smIcon18",className:H(E)})))))},J=({displayedRows:a})=>{const{isWideScreens:s}=w(),e="whitespace-nowrap px-6 text-small font-medium text-darkBase dark:text-whiteBase lg:text-medium group-hover:text-whiteBase transition-colors duration-500";return t.createElement(I,{isOpen:!0,orientation:"horizontal"},t.createElement("table",{className:"mb-2.5 min-w-full divide-y divide-greyAlt/[.4] transition-colors duration-500 dark:divide-greyBase/[.4]"},t.createElement("thead",{className:"bg-accentBase/[.2] transition-colors duration-500 dark:bg-greyBase/[.4]"},t.createElement("tr",null,Array.isArray(S)&&S.map(({label:n})=>t.createElement("th",{key:n,scope:"col",className:"px-6 py-3 text-start text-xs font-medium uppercase text-greyBase transition-colors duration-500 dark:text-whiteBase md:text-small lg:text-xl"},n)))),t.createElement("tbody",{className:"divide-y divide-whiteBase transition-colors duration-500 dark:divide-gray-700"},Array.isArray(a)&&a.map(({title:n,newsUrl:o,category:r,additionDate:c,deletionDate:d})=>t.createElement("tr",{key:o,className:"group transition-colors duration-500 even:bg-greyAlt/[.1] hover:bg-accentBase/65"},t.createElement("td",{className:e},t.createElement("a",{href:o,target:"_blank",rel:"noopener noreferrer nofollow",className:"block py-4 lg:text-medium"},X(n,s))),t.createElement("td",{className:e},r),t.createElement("td",{className:e},C(c).dayMonthYear),t.createElement("td",{className:e},C(d).dayMonthYear))))))},M=({handlePageChange:a,currentPage:s,label:e,position:n,iconClass:o})=>{const{archiveHistoryLog:r}=k(),c=n<s,d=s===n||(r==null?void 0:r.length)===0,l="group inline-flex items-center gap-x-2 rounded-full p-2.5 transition-colors duration-500 hocus:bg-accentBase disabled:pointer-events-none disabled:opacity-50 dark:hocus:bg-accentBase dark:focus:outline-none dark:focus:ring-1 dark:focus:ring-gray-600";return t.createElement("button",{type:"button",onClick:()=>a(c?s-1:s+1),disabled:d,className:l},t.createElement("span",{"aria-hidden":"true"},t.createElement(D,{svgName:"arrow",sizeKey:"xsIcon14",className:`${o} fill-accentBase group-hover:fill-whiteBase group-focus:fill-whiteBase dark:fill-whiteBase`})),t.createElement("span",{className:"sr-only"},e))},Q=4,Z=5,B=2,y=3,x=1,P=({currentPage:a,handlePageChange:s,totalPages:e})=>{const{isSmallScreens:n}=w(),o=()=>{const c=[],d=(m,f)=>m===f?"bg-accentBase text-whiteBase":"bg-transparent text-darkBase dark:text-whiteBase",l=(m,f)=>{for(let h=m;h<=f;h+=x)c.push(t.createElement("button",{key:h,type:"button","aria-current":"page",className:`${r} ${d(a,h)}`,onClick:()=>s(h)},h))},i=m=>{c.push(t.createElement("span",{key:`dots ${m}`,className:"flex w-10 items-center justify-center text-darkBase dark:text-whiteBase"},"..."))},p=()=>{c.push(t.createElement("button",{key:e,type:"button","aria-current":"page",className:`${r} ${d(a,e)}`,onClick:()=>s(e)},e))},E=a+B===e||a+x===e||a===e,b=a+y===e||a+B===e||a+x===e||a===e;return n?e<=Q?l(x,e):a===x?(l(x,B),i("next"),p()):E?(i("prev"),l(e-B,e)):a+B<e&&(i("prev"),l(a,a),i("next"),p()):e<=Z?l(x,e):a===x?(l(x,y),i("next"),p()):b?(i("prev"),l(e-y,e)):a+y<e&&(i("prev"),l(a,a+x),i("next"),p()),c},r="flex w-10 h-10 items-center justify-center rounded-full py-2.5 text-small text-darkBase transition-colors duration-500 hocus:bg-accentBase hocus:text-whiteBase dark:text-whiteBase dark:hocus:bg-accentBase lg:text-medium";return t.createElement(t.Fragment,null,o())},ee=({handlePageChange:a,currentPage:s,totalPages:e})=>t.createElement("nav",{className:"flex items-center space-x-1 py-2"},t.createElement(M,{handlePageChange:a,currentPage:s,label:"Previous",position:1,iconClass:"rotate-90"}),t.createElement(P,{currentPage:s,totalPages:e,handlePageChange:a}),t.createElement(M,{handlePageChange:a,currentPage:s,label:"Next",position:e,iconClass:"-rotate-90"})),N=1,v=7,te=a=>{const[s,e]=g.useState(""),[n,o]=g.useState(N),r=g.useMemo(()=>s?a.filter(m=>m.title.toLowerCase().includes(s.toLowerCase())):a,[a,s]),c=r.length,d=Math.ceil(c/v),l=(n-N)*v,i=l+v,p=r.slice(l,i),E=g.useCallback(m=>{const f=m.target.value;e(f),o(N)},[]),b=g.useCallback(m=>{m>=N&&m<=d&&o(m)},[d]);return{searchValue:s,currentPage:n,totalPages:d,displayedRows:p,handleSearchNews:E,handlePageChange:b}},ae=({logData:a})=>{const{clearLog:s,archiveHistoryLog:e}=k(),{showToast:n}=_(),{isSmallScreens:o,isNotMobile:r}=w(),{isOpenModal:c,modalType:d}=R(),{toggleModal:l,popUpRef:i}=L(),{searchValue:p,currentPage:E,totalPages:b,displayedRows:m,handlePageChange:f,handleSearchNews:h}=te(a),A=async()=>{try{const u=await s();n(u.meta.requestStatus)}catch(u){throw console.error("Error during clearLog:",u),u}l()};return t.createElement(t.Fragment,null,t.createElement("div",{className:`${(e==null?void 0:e.length)===0?"mb-5":"mb-10"} flex flex-col overflow-hidden rounded-lg shadow-modal`},t.createElement("div",{className:"inline-block min-w-full align-middle"},t.createElement("div",{className:"divide-y divide-greyAlt/[.4] overflow-hidden rounded-lg border dark:divide-greyBase/[.4] dark:border-greyBase/[.4]"},t.createElement("div",{className:"px-4 py-3 lg:px-6 lg:py-5"},t.createElement("div",{className:"relative max-md:w-[254px] md:flex md:flex-row-reverse md:items-center md:justify-between"},o?t.createElement(T,{toggleModal:u=>l(u,!0,"clearLog")}):null,t.createElement("h3",{className:"mb-4 text-2xl font-medium text-darkBase dark:text-whiteBase"},"Deleted news"),(e==null?void 0:e.length)>0?t.createElement("div",null,t.createElement(U,{inputData:{name:"Deleted news",type:"text",value:p,placeholder:"Title"},hasIcon:!0,svgName:"search",onChange:u=>h(u),variant:O.FilterServiceBlock})):null)),t.createElement(J,{displayedRows:m}),t.createElement("div",{className:"flex justify-between px-4 lg:px-6"},t.createElement(ee,{handlePageChange:f,currentPage:E,totalPages:b}),r?t.createElement("div",{className:"flex gap-x-7"},t.createElement(T,{toggleModal:u=>l(u,!0,"clearLog")})):null)))),c&&d==="clearLog"&&t.createElement($,{closeModal:l,modalRef:i},t.createElement(W,{handleClose:u=>l(u),handleDelete:A,title:"Clear log"})))},re=()=>{const{allArchive:a,archiveHistoryLog:s,getHistoryLog:e,getArchives:n}=k();g.useEffect(()=>{n(),e()},[n,e]);const o=K(a);return t.createElement(j,null,t.createElement(ae,{logData:s}),(s==null?void 0:s.length)===0?t.createElement("p",{className:"mb-5 text-right text-darkBase dark:text-whiteBase"},"This log will include your deleted news"):null,Object.entries(o).reverse().map(([r,c])=>t.createElement(F,{key:r,dateSeparator:r,position:"archivePage"},t.createElement(G,{currentItems:c}))))};export{re as default};

import{j as C,d as S,b as k,R as e,S as D,C as L,r as g,k as A,l as I,m as _,U as R,n as $,M as U,A as O}from"./index-a82b227f.js";import{D as F,P as j,N as W}from"./PageTemplate-a9495069.js";import"./images-e5f9d343.js";import"./Toast-a10e91b5.js";const v=[{label:"Title"},{label:"Category"},{label:"Addition Date"},{label:"Deletion Date"}],G=a=>[{type:"submit",iconName:"reset",label:"Update log",disabled:a},{type:"button",iconName:"trash",label:"Clear log"}],V=56,z=87,H=a=>{const s={};return(a==null?void 0:a.length)>0&&a.forEach(t=>{const n=t==null?void 0:t.additionDate;if(n){const l=C(n).fullMonthYear;s[l]||(s[l]=[]),s[l].push(t)}}),s},q=(a,s)=>{let t;switch(!0){case s:t=z;break;default:t=V;break}return a.length>t?`${a.slice(0,t)}...`:a},M=({toggleModal:a})=>{const{getHistoryLog:s,dbSuccessMessage:t}=S(),{isNotMobile:n}=k(),l=(o,r)=>`${r?"text-greyAlt dark:text-greyBase":"text-accentBase hocus:text-accentAlt dark:text-whiteBase dark:hocus:text-accentBase"} ${o==="reset"?"max-md:right-12":"max-md:right-0"} group flex items-center gap-x-4 transition-colors duration-500 max-md:absolute max-md:top-0 max-md:h-10 max-md:w-10 max-md:justify-center`,i=o=>`${o?"fill-greyAlt dark:fill-greyBase":"fill-accentBase group-hover:fill-accentAlt group-focus:fill-accentAlt dark:fill-whiteBase dark:group-hover:fill-accentBase dark:group-focus:fill-accentBase"}`,c=G(t!=="Remove news success");return e.createElement(e.Fragment,null,Array.isArray(c)&&c.map(({type:o,iconName:r,label:p,disabled:x})=>e.createElement(e.Fragment,{key:r},e.createElement("button",{type:o,disabled:x,onClick:o==="button"?a:s,className:l(r,x)},n?p:null,e.createElement(D,{svgName:r,sizeKey:"smIcon18",className:i(x)})))))},K=({displayedRows:a})=>{const{wideScreens:s}=k(),t="whitespace-nowrap px-6 text-small font-medium text-darkBase dark:text-whiteBase lg:text-medium group-hover:text-whiteBase transition-colors duration-500";return e.createElement(L,{isOpen:!0,orientation:"horizontal"},e.createElement("table",{className:"mb-2.5 min-w-full divide-y divide-greyAlt/[.4] transition-colors duration-500 dark:divide-greyBase/[.4]"},e.createElement("thead",{className:"bg-accentBase/[.2] transition-colors duration-500 dark:bg-greyBase/[.4]"},e.createElement("tr",null,v==null?void 0:v.map(({label:n})=>e.createElement("th",{key:n,scope:"col",className:"px-6 py-3 text-start text-xs font-medium uppercase text-greyBase transition-colors duration-500 dark:text-whiteBase md:text-small lg:text-xl"},n)))),e.createElement("tbody",{className:"divide-y divide-whiteBase transition-colors duration-500 dark:divide-gray-700"},Array.isArray(a)&&a.map(({title:n,newsUrl:l,category:i,additionDate:d,deletionDate:c})=>e.createElement("tr",{key:l,className:"group transition-colors duration-500 even:bg-greyAlt/[.1] hover:bg-accentBase/65"},e.createElement("td",{className:`${t}`},e.createElement("a",{href:l,target:"_blank",rel:"noopener noreferrer nofollow",className:"block py-4 lg:text-medium"},q(n,s))),e.createElement("td",{className:`${t}`},i),e.createElement("td",{className:`${t}`},C(d).dayMonthYear),e.createElement("td",{className:`${t}`},C(c).dayMonthYear))))))},T=({handlePageChange:a,currentPage:s,label:t,position:n,iconClass:l})=>{const i=n<s,d="group inline-flex items-center gap-x-2 rounded-full p-2.5 transition-colors duration-500 hocus:bg-accentBase disabled:pointer-events-none disabled:opacity-50 dark:hocus:bg-accentBase dark:focus:outline-none dark:focus:ring-1 dark:focus:ring-gray-600";return e.createElement("button",{type:"button",onClick:()=>a(i?s-1:s+1),disabled:s===n,className:d},e.createElement("span",{"aria-hidden":"true"},e.createElement(D,{svgName:"arrow",sizeKey:"xsIcon14",className:`${l} fill-accentBase group-hover:fill-whiteBase group-focus:fill-whiteBase dark:fill-whiteBase`})),e.createElement("span",{className:"sr-only"},t))},X=4,Y=5,y=2,B=3,E=1,J=({currentPage:a,handlePageChange:s,totalPages:t})=>{const{isMobile:n}=k(),l=()=>{const d=[],c=(m,h)=>m===h?"bg-accentBase text-whiteBase":"bg-transparent text-darkBase dark:text-whiteBase",o=(m,h)=>{for(let f=m;f<=h;f+=E)d.push(e.createElement("button",{key:f,type:"button","aria-current":"page",className:`${i} ${c(a,f)}`,onClick:()=>s(f)},f))},r=m=>{d.push(e.createElement("span",{key:`dots${m}`,className:"flex w-10 items-center justify-center text-darkBase dark:text-whiteBase"},"..."))},p=()=>{d.push(e.createElement("button",{key:t,type:"button","aria-current":"page",className:`${i} ${c(a,t)}`,onClick:()=>s(t)},t))},x=a+y===t||a+E===t||a===t,b=a+B===t||a+y===t||a+E===t||a===t;return n?t<=X?o(E,t):a===E?(o(E,y),r("next"),p()):x?(r("prev"),o(t-y,t)):a+y<t&&(r("prev"),o(a,a),r("next"),p()):t<=Y?o(E,t):a===E?(o(E,B),r("next"),p()):b?(r("prev"),o(t-B,t)):a+B<t&&(r("prev"),o(a,a+E),r("next"),p()),d},i="flex w-10 h-10 items-center justify-center rounded-full py-2.5 text-small text-darkBase transition-colors duration-500 hocus:bg-accentBase hocus:text-whiteBase dark:text-whiteBase dark:hocus:bg-accentBase lg:text-medium";return e.createElement(e.Fragment,null,l())},Q=({handlePageChange:a,currentPage:s,totalPages:t})=>e.createElement("nav",{className:"flex items-center space-x-1 py-2"},e.createElement(T,{handlePageChange:a,currentPage:s,label:"Previous",position:1,iconClass:"rotate-90"}),e.createElement(J,{currentPage:s,totalPages:t,handlePageChange:a}),e.createElement(T,{handlePageChange:a,currentPage:s,label:"Next",position:t,iconClass:"-rotate-90"})),N=1,w=7,Z=a=>{const[s,t]=g.useState(""),[n,l]=g.useState(N),i=g.useMemo(()=>s?a.filter(m=>m.title.toLowerCase().includes(s.toLowerCase())):a,[a,s]),d=i.length,c=Math.ceil(d/w),o=(n-N)*w,r=o+w,p=i.slice(o,r),x=g.useCallback(m=>{const h=m.target.value;t(h),l(N)},[]),b=g.useCallback(m=>{m>=N&&m<=c&&l(m)},[c]);return{searchValue:s,currentPage:n,totalPages:c,displayedRows:p,handleSearchNews:x,handlePageChange:b}},P=({logData:a})=>{const{clearLog:s}=S(),{showToast:t}=A(),{isMobile:n,isNotMobile:l}=k(),{isOpenModal:i,modalType:d}=I(),{toggleModal:c,popUpRef:o}=_(),{searchValue:r,currentPage:p,totalPages:x,displayedRows:b,handlePageChange:m,handleSearchNews:h}=Z(a),f=async()=>{try{const u=await s();t(u.meta.requestStatus)}catch(u){console.error("Error during clearLog:",u)}c()};return e.createElement(e.Fragment,null,e.createElement("div",{className:"mb-10 flex flex-col overflow-hidden rounded-lg shadow-modal"},e.createElement("div",{className:"inline-block min-w-full align-middle"},e.createElement("div",{className:"divide-y divide-greyAlt/[.4] overflow-hidden rounded-lg border dark:divide-greyBase/[.4] dark:border-greyBase/[.4]"},e.createElement("div",{className:"px-4 py-3 lg:px-6 lg:py-5"},e.createElement("div",{className:"relative max-md:w-[254px] md:flex md:flex-row-reverse md:items-center md:justify-between"},n?e.createElement(M,{toggleModal:u=>c(u,!0,"clearLog")}):null,e.createElement("h3",{className:"mb-4 text-2xl font-medium text-darkBase dark:text-whiteBase"},"Deleted news"),e.createElement("div",null,e.createElement(R,{inputData:{name:"Deleted news",type:"text",value:r,placeholder:"Title"},hasIcon:!0,svgName:"search",onChange:u=>h(u),variant:$.FilterServiceBlock})))),e.createElement(K,{displayedRows:b}),e.createElement("div",{className:"flex justify-between px-4 lg:px-6"},e.createElement(Q,{handlePageChange:m,currentPage:p,totalPages:x}),l?e.createElement("div",{className:"flex gap-x-7"},e.createElement(M,{toggleModal:u=>c(u,!0,"clearLog")})):null)))),i&&d==="clearLog"&&e.createElement(U,{closeModal:c,modalRef:o},e.createElement(F,{handleClose:u=>c(u),handleDelete:f,position:"clearLog",title:"Clear log",agreementText:"clear the log of deleted"})))},ne=()=>{const{allArchive:a,archiveHistoryLog:s,getHistoryLog:t,getArchives:n}=S();g.useEffect(()=>{n(),t()},[n,t]);const l=H(a);return e.createElement(j,null,(s==null?void 0:s.length)>0?e.createElement(P,{logData:s}):null,Object.entries(l).reverse().map(([i,d])=>e.createElement(O,{key:i,dateSeparator:i,position:"archivePage"},e.createElement(W,{currentItems:d}))))};export{ne as default};

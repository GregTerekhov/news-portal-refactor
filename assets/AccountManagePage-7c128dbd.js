import{t as h,v as P,a5 as n,I as g,a6 as v,a7 as $,a8 as C,a9 as S,aa as D,g as y,o as B,ab as k,ac as A,ad as T,R as s,A as L,k as q,ae as M,af as W,P as j,B as G,b as x,V as O,S as I,ag as Y,a4 as z,a3 as N}from"./index-bbedbc49.js";import{T as J}from"./Toast-9151dc6f.js";const K=({newPassword:e,confirmPassword:o,password:t,errors:a})=>{var l,i,u,r,m;const d=[{type:h.Password,placeholder:P.NewPassword,fieldValue:e,errors:(l=a==null?void 0:a.newPassword)==null?void 0:l.message,label:n.NewPassword,ariaInvalid:!!(a!=null&&a.newPassword),iconName:g.Password,autoFocus:!0},{type:h.Password,placeholder:P.ConfirmPassword,fieldValue:o,errors:(i=a==null?void 0:a.confirmPassword)==null?void 0:i.message,label:n.ConfirmPassword,ariaInvalid:!!(a!=null&&a.confirmPassword),iconName:g.Password}];return!!e&&!!o&&!((u=a==null?void 0:a.newPassword)!=null&&u.message)&&!((r=a==null?void 0:a.confirmPassword)!=null&&r.message)&&d.push({type:h.Password,placeholder:P.CurrentPassword,fieldValue:t,errors:(m=a==null?void 0:a.password)==null?void 0:m.message,label:n.Password,ariaInvalid:!!(a!=null&&a.password),iconName:g.Password}),d},Q=({email:e,password:o,errors:t})=>{var c,l,i;const a=[{type:h.Email,placeholder:P.NewEmail,fieldValue:e,errors:(c=t==null?void 0:t.email)==null?void 0:c.message,label:n.Email,iconName:g.Envelop,ariaInvalid:!!(t!=null&&t.email),autofill:"email",autoFocus:!0}];return e&&!((l=t==null?void 0:t.email)!=null&&l.message)&&e.length!==0&&a.push({type:h.Password,placeholder:P.CurrentPassword,fieldValue:o,errors:(i=t==null?void 0:t.password)==null?void 0:i.message,label:n.Password,iconName:g.Password,ariaInvalid:!!(t!=null&&t.password)}),a},X=v({email:$(),password:C()}),Z=v({newPassword:S(),confirmPassword:D(S()),password:C()}),_=e=>{switch(e){case n.Email:return"and confirm by inputting your current password in the new field.";case n.Password:return"in the first field and repeat the entry in the second field. In the third field, confirm the change by inputting your current password.";default:return""}},aa=(e,o)=>!!(e===n.Email&&o),ea=()=>{const{requestStatus:e,updateEmail:o}=y(),{showToast:t}=B(),{handleSubmit:a,register:d,watch:c,reset:l,getValues:i,formState:{errors:u}}=k({resolver:A(X),defaultValues:{email:"",password:""}}),[r,m]=c([n.Email,n.Password]);return{emailSubmit:a,updateEmailRegister:d,errors:u,email:r,handleEmailSubmitHandler:async f=>{try{await o(f),T(),e&&t(e)}catch(w){throw console.error("Error during updateEmail: ",w),w}finally{l({...i,email:"",password:""})}},emailInputs:Q({email:r,password:m,errors:u})}},ta=()=>{const{requestStatus:e,updatePassword:o}=y(),{showToast:t}=B(),{handleSubmit:a,register:d,watch:c,reset:l,getValues:i,formState:{errors:u}}=k({resolver:A(Z),defaultValues:{newPassword:"",confirmPassword:"",password:""}}),[r,m,E]=c([n.NewPassword,n.ConfirmPassword,n.Password]);return{passwordSubmit:a,updatePasswordRegister:d,handlePasswordSubmitHandler:async w=>{try{const{newPassword:p,password:b}=w;await o({password:b,newPassword:p}),T(),e&&t(e)}catch(p){throw console.error("Error during updatePassword: ",p),p}finally{l({...i,newPassword:"",confirmPassword:"",password:""})}},passwordInputs:K({newPassword:r,confirmPassword:m,password:E,errors:u})}},V=({field:e})=>{const{isRefreshingUser:o}=y(),{emailSubmit:t,updateEmailRegister:a,emailInputs:d,handleEmailSubmitHandler:c}=ea(),{passwordSubmit:l,updatePasswordRegister:i,handlePasswordSubmitHandler:u,passwordInputs:r}=ta(),m=e===n.Email?d:r,E=_(e),f=aa(e,o);return s.createElement(L,{position:q.AccountSettings,blockDefinition:`Change your ${e}`},s.createElement("form",{className:"space-y-4 pt-4 lg:space-y-8",onSubmit:e===n.Email?t(c):l(u)},s.createElement("ul",{className:"space-y-4 lg:space-y-8"},Array.isArray(m)&&m.map(({label:w,type:p,placeholder:b,fieldValue:U,errors:R,iconName:F,ariaInvalid:H})=>s.createElement("li",{key:w},s.createElement(M,{inputData:{type:p,placeholder:b,fieldValue:U},errors:R,register:e===n.Email?a:i,label:w,hasIcon:!0,svgName:F,variant:W.Account,ariaInvalid:H})))),s.createElement("p",{className:"text-small text-darkBase dark:text-whiteBase lg:text-medium hg:text-xl"},`To change your current ${e}, enter the new ${e} ${E} If all information is entered correctly, you will receive a
          notification confirming the successful update of your ${e}.`),s.createElement(j,{type:G.Submit,width:"w-28 lg:w-40",id:n.Password?x.UpdatePassword:x.UpdateEmail,variant:O.Other,disabled:f},"Apply")))},oa=()=>{const{authError:e,statusMessage:o}=y(),t=o===I.UpdateEmail||o===I.UpdatePassword||o.includes("linking"),a=t||typeof e=="string";return s.createElement("div",null,s.createElement("h2",{className:"mb-14 text-end text-3xl leading-tighter text-darkBase dark:text-whiteBase hg:text-5xl"},"Account settings"),s.createElement("div",{className:"flex items-center justify-end"},s.createElement("div",{className:"w-52 space-y-2 md:w-80 md:space-y-6 lg:w-600px"},s.createElement(s.Fragment,null,s.createElement(V,{field:n.Email}),s.createElement(V,{field:n.Password})),s.createElement("h3",{className:"text-darkBase dark:text-whiteBase md:text-2xl lg:mb-4 hg:text-3xl"},"Connected accounts"),s.createElement("p",{className:"text-small leading-normal text-darkBase dark:text-whiteBase lg:text-medium hg:text-xl"},"You can connect or disconnect your News account to Google, Facebook, or Apple to log in using this account. We will never send messages to your contacts without your permission."),s.createElement("hr",{className:"!border-greyAlt dark:!border-whiteBase"}),s.createElement(Y,null))),a?s.createElement(J,{variant:z.Foreground,status:t?N.Success:N.Error}):null)};export{oa as default};

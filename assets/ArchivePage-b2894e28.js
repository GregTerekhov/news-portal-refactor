import{j as w,d as C,b as k,R as e,S as D,C as A,r as g,k as L,l as I,m as _,U as R,n as U,M as O,A as $}from"./index-93d05abb.js";import{D as F,P as j,N as W}from"./PageTemplate-bdaedbef.js";import"./images-506cde73.js";import"./Toast-7875f377.js";const S=[{label:"Title"},{label:"Category"},{label:"Addition Date"},{label:"Deletion Date"}],G=a=>[{type:"submit",iconName:"reset",label:"Update log",disabled:a},{type:"button",iconName:"trash",label:"Clear log"}],H=56,V=87,z=a=>{const s={};return(a==null?void 0:a.length)>0&&a.forEach(t=>{const n=t==null?void 0:t.additionDate;if(n){const o=w(n).fullMonthYear;s[o]||(s[o]=[]),s[o].push(t)}}),s},q=(a,s)=>{let t;switch(!0){case s:t=V;break;default:t=H;break}return a.length>t?`${a.slice(0,t)}...`:a},M=({toggleModal:a})=>{const{getHistoryLog:s,dbSuccessMessage:t}=C(),{isNotMobile:n}=k(),o=(l,r)=>`${r?"text-greyAlt dark:text-greyBase":"text-accentBase hocus:text-accentAlt dark:text-whiteBase dark:hocus:text-accentBase"} ${l==="reset"?"max-md:right-12":"max-md:right-0"} group flex items-center gap-x-4 transition-colors duration-500 max-md:absolute max-md:top-0 max-md:h-10 max-md:w-10 max-md:justify-center`,i=l=>`${l?"fill-greyAlt dark:fill-greyBase":"fill-accentBase group-hover:fill-accentAlt group-focus:fill-accentAlt dark:fill-whiteBase dark:group-hover:fill-accentBase dark:group-focus:fill-accentBase"}`,c=G(t!=="Remove news success");return e.createElement(e.Fragment,null,Array.isArray(c)&&c.map(({type:l,iconName:r,label:p,disabled:x})=>e.createElement(e.Fragment,{key:r},e.createElement("button",{type:l,disabled:x,onClick:l==="button"?a:s,className:o(r,x)},n?p:null,e.createElement(D,{svgName:r,sizeKey:"smIcon18",className:i(x)})))))},K=({displayedRows:a})=>{const{wideScreens:s}=k(),t="whitespace-nowrap px-6 text-small font-medium text-darkBase dark:text-whiteBase lg:text-medium group-hover:text-whiteBase transition-colors duration-500";return e.createElement(A,{isOpen:!0,orientation:"horizontal"},e.createElement("table",{className:"mb-2.5 min-w-full divide-y divide-greyAlt/[.4] transition-colors duration-500 dark:divide-greyBase/[.4]"},e.createElement("thead",{className:"bg-accentBase/[.2] transition-colors duration-500 dark:bg-greyBase/[.4]"},e.createElement("tr",null,Array.isArray(S)&&S.map(({label:n})=>e.createElement("th",{key:n,scope:"col",className:"px-6 py-3 text-start text-xs font-medium uppercase text-greyBase transition-colors duration-500 dark:text-whiteBase md:text-small lg:text-xl"},n)))),e.createElement("tbody",{className:"divide-y divide-whiteBase transition-colors duration-500 dark:divide-gray-700"},Array.isArray(a)&&a.map(({title:n,newsUrl:o,category:i,additionDate:d,deletionDate:c})=>e.createElement("tr",{key:o,className:"group transition-colors duration-500 even:bg-greyAlt/[.1] hover:bg-accentBase/65"},e.createElement("td",{className:t},e.createElement("a",{href:o,target:"_blank",rel:"noopener noreferrer nofollow",className:"block py-4 lg:text-medium"},q(n,s))),e.createElement("td",{className:t},i),e.createElement("td",{className:t},w(d).dayMonthYear),e.createElement("td",{className:t},w(c).dayMonthYear))))))},T=({handlePageChange:a,currentPage:s,label:t,position:n,iconClass:o})=>{const i=n<s,d="group inline-flex items-center gap-x-2 rounded-full p-2.5 transition-colors duration-500 hocus:bg-accentBase disabled:pointer-events-none disabled:opacity-50 dark:hocus:bg-accentBase dark:focus:outline-none dark:focus:ring-1 dark:focus:ring-gray-600";return e.createElement("button",{type:"button",onClick:()=>a(i?s-1:s+1),disabled:s===n,className:d},e.createElement("span",{"aria-hidden":"true"},e.createElement(D,{svgName:"arrow",sizeKey:"xsIcon14",className:`${o} fill-accentBase group-hover:fill-whiteBase group-focus:fill-whiteBase dark:fill-whiteBase`})),e.createElement("span",{className:"sr-only"},t))},X=4,Y=5,y=2,B=3,E=1,J=({currentPage:a,handlePageChange:s,totalPages:t})=>{const{isMobile:n}=k(),o=()=>{const d=[],c=(m,f)=>m===f?"bg-accentBase text-whiteBase":"bg-transparent text-darkBase dark:text-whiteBase",l=(m,f)=>{for(let h=m;h<=f;h+=E)d.push(e.createElement("button",{key:h,type:"button","aria-current":"page",className:`${i} ${c(a,h)}`,onClick:()=>s(h)},h))},r=m=>{d.push(e.createElement("span",{key:`dots${m}`,className:"flex w-10 items-center justify-center text-darkBase dark:text-whiteBase"},"..."))},p=()=>{d.push(e.createElement("button",{key:t,type:"button","aria-current":"page",className:`${i} ${c(a,t)}`,onClick:()=>s(t)},t))},x=a+y===t||a+E===t||a===t,b=a+B===t||a+y===t||a+E===t||a===t;return n?t<=X?l(E,t):a===E?(l(E,y),r("next"),p()):x?(r("prev"),l(t-y,t)):a+y<t&&(r("prev"),l(a,a),r("next"),p()):t<=Y?l(E,t):a===E?(l(E,B),r("next"),p()):b?(r("prev"),l(t-B,t)):a+B<t&&(r("prev"),l(a,a+E),r("next"),p()),d},i="flex w-10 h-10 items-center justify-center rounded-full py-2.5 text-small text-darkBase transition-colors duration-500 hocus:bg-accentBase hocus:text-whiteBase dark:text-whiteBase dark:hocus:bg-accentBase lg:text-medium";return e.createElement(e.Fragment,null,o())},Q=({handlePageChange:a,currentPage:s,totalPages:t})=>e.createElement("nav",{className:"flex items-center space-x-1 py-2"},e.createElement(T,{handlePageChange:a,currentPage:s,label:"Previous",position:1,iconClass:"rotate-90"}),e.createElement(J,{currentPage:s,totalPages:t,handlePageChange:a}),e.createElement(T,{handlePageChange:a,currentPage:s,label:"Next",position:t,iconClass:"-rotate-90"})),N=1,v=7,Z=a=>{const[s,t]=g.useState(""),[n,o]=g.useState(N),i=g.useMemo(()=>s?a.filter(m=>m.title.toLowerCase().includes(s.toLowerCase())):a,[a,s]),d=i.length,c=Math.ceil(d/v),l=(n-N)*v,r=l+v,p=i.slice(l,r),x=g.useCallback(m=>{const f=m.target.value;t(f),o(N)},[]),b=g.useCallback(m=>{m>=N&&m<=c&&o(m)},[c]);return{searchValue:s,currentPage:n,totalPages:c,displayedRows:p,handleSearchNews:x,handlePageChange:b}},P=({logData:a})=>{const{clearLog:s}=C(),{showToast:t}=L(),{isMobile:n,isNotMobile:o}=k(),{isOpenModal:i,modalType:d}=I(),{toggleModal:c,popUpRef:l}=_(),{searchValue:r,currentPage:p,totalPages:x,displayedRows:b,handlePageChange:m,handleSearchNews:f}=Z(a),h=async()=>{try{const u=await s();t(u.meta.requestStatus)}catch(u){throw console.error("Error during clearLog:",u),u}c()};return e.createElement(e.Fragment,null,e.createElement("div",{className:"mb-10 flex flex-col overflow-hidden rounded-lg shadow-modal"},e.createElement("div",{className:"inline-block min-w-full align-middle"},e.createElement("div",{className:"divide-y divide-greyAlt/[.4] overflow-hidden rounded-lg border dark:divide-greyBase/[.4] dark:border-greyBase/[.4]"},e.createElement("div",{className:"px-4 py-3 lg:px-6 lg:py-5"},e.createElement("div",{className:"relative max-md:w-[254px] md:flex md:flex-row-reverse md:items-center md:justify-between"},n?e.createElement(M,{toggleModal:u=>c(u,!0,"clearLog")}):null,e.createElement("h3",{className:"mb-4 text-2xl font-medium text-darkBase dark:text-whiteBase"},"Deleted news"),e.createElement("div",null,e.createElement(R,{inputData:{name:"Deleted news",type:"text",value:r,placeholder:"Title"},hasIcon:!0,svgName:"search",onChange:u=>f(u),variant:U.FilterServiceBlock})))),e.createElement(K,{displayedRows:b}),e.createElement("div",{className:"flex justify-between px-4 lg:px-6"},e.createElement(Q,{handlePageChange:m,currentPage:p,totalPages:x}),o?e.createElement("div",{className:"flex gap-x-7"},e.createElement(M,{toggleModal:u=>c(u,!0,"clearLog")})):null)))),i&&d==="clearLog"&&e.createElement(O,{closeModal:c,modalRef:l},e.createElement(F,{handleClose:u=>c(u),handleDelete:h,position:"clearLog",title:"Clear log",agreementText:"clear the log of deleted"})))},ne=()=>{const{allArchive:a,archiveHistoryLog:s,getHistoryLog:t,getArchives:n}=C();g.useEffect(()=>{n(),t()},[n,t]);const o=z(a);return e.createElement(j,null,(s==null?void 0:s.length)>0?e.createElement(P,{logData:s}):null,Object.entries(o).reverse().map(([i,d])=>e.createElement($,{key:i,dateSeparator:i,position:"archivePage"},e.createElement(W,{currentItems:d}))))};export{ne as default};
